<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Copilot 1СО</title>
        <link
            rel="icon"
            href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><title>SOS Icon (Red)</title><defs><style>.sos-text{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size:12px;font-weight:bold;text-anchor:middle;dominant-baseline:central;fill:%23DC2626;letter-spacing:-0.5px}.frame{fill:none;stroke:%23DC2626;stroke-width:2}</style></defs><rect x="4" y="4" width="24" height="24" rx="4" class="frame"/><text x="16" y="16" class="sos-text">SOS</text></svg>'
        />
        <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.14.0/Sortable.min.js"></script>
        <script src="https://cdn.tailwindcss.com"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
            integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <script>
            tailwind.config = {
                darkMode: 'class',
                theme: {
                    extend: {
                        colors: {
                            primary: 'var(--color-primary, #5D5CDE)',
                            secondary: 'var(--color-secondary, #4B4AB2)',
                            blue: {
                                ...tailwind.colors.blue,
                                DEFAULT: 'var(--color-primary, #5D5CDE)',
                            },
                        },

                        borderRadius: {
                            none: '0px',
                            sm: 'calc(var(--border-radius, 8px) * 0.5)',
                            DEFAULT: 'var(--border-radius, 8px)',
                            md: 'calc(var(--border-radius, 8px) * 0.75)',
                            lg: 'calc(var(--border-radius, 8px) * 1.25)',
                            xl: 'calc(var(--border-radius, 8px) * 1.75)',
                            '2xl': 'calc(var(--border-radius, 8px) * 2.25)',
                            '3xl': 'calc(var(--border-radius, 8px) * 3.0)',
                            full: '9999px',
                        },

                        spacing: {
                            content: 'var(--content-spacing, 1rem)',
                            'content-sm': 'calc(var(--content-spacing, 1rem) * 0.75)',
                            'content-lg': 'calc(var(--content-spacing, 1rem) * 1.5)',
                        },

                        gap: (theme) => ({
                            ...theme('spacing'),
                        }),

                        padding: (theme) => ({
                            ...theme('spacing'),
                        }),

                        margin: (theme) => ({
                            ...theme('spacing'),
                        }),
                    },
                },
            };
        </script>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
        <style id="scrollbar-theme">
            html {
                color-scheme: light;
            }
            html.dark {
                color-scheme: dark;
            }

            /* --- LIGHT ----------------------------------------------------------- */
            html:not(.dark),
            html:not(.dark) body {
                scrollbar-color: var(--override-scrollbar-thumb-light, var(--color-border))
                    var(--override-scrollbar-track-light, var(--color-surface-2)) !important;
                scrollbar-width: thin;
            }
            /* Chromium/WebKit — корневой + вложенные */
            html:not(.dark)::-webkit-scrollbar,
            html:not(.dark) body::-webkit-scrollbar,
            html:not(.dark) *::-webkit-scrollbar {
                width: 12px;
                height: 12px;
            }
            html:not(.dark)::-webkit-scrollbar-track,
            html:not(.dark) body::-webkit-scrollbar-track,
            html:not(.dark) *::-webkit-scrollbar-track {
                background: var(
                    --override-scrollbar-track-light,
                    var(--color-surface-2)
                ) !important;
            }
            html:not(.dark)::-webkit-scrollbar-thumb,
            html:not(.dark) body::-webkit-scrollbar-thumb,
            html:not(.dark) *::-webkit-scrollbar-thumb {
                background: var(--override-scrollbar-thumb-light, var(--color-border)) !important;
                border-radius: var(--border-radius) !important;
                border: 2px solid var(--override-scrollbar-track-light, var(--color-surface-2)) !important;
            }
            html:not(.dark)::-webkit-scrollbar-corner,
            html:not(.dark) body::-webkit-scrollbar-corner {
                background: var(
                    --override-scrollbar-track-light,
                    var(--color-surface-2)
                ) !important;
            }

            /* --- DARK ------------------------------------------------------------ */
            html.dark,
            html.dark body {
                scrollbar-color: var(
                        --override-scrollbar-thumb-dark,
                        var(--color-border-interactive)
                    )
                    var(--override-scrollbar-track-dark, var(--color-surface-2)) !important;
                scrollbar-width: thin;
            }
            html.dark::-webkit-scrollbar,
            html.dark body::-webkit-scrollbar,
            html.dark *::-webkit-scrollbar {
                width: 12px;
                height: 12px;
            }
            html.dark::-webkit-scrollbar-track,
            html.dark body::-webkit-scrollbar-track,
            html.dark *::-webkit-scrollbar-track {
                background: var(--override-scrollbar-track-dark, var(--color-surface-2)) !important;
            }
            html.dark::-webkit-scrollbar-thumb,
            html.dark body::-webkit-scrollbar-thumb,
            html.dark *::-webkit-scrollbar-thumb {
                background: var(
                    --override-scrollbar-thumb-dark,
                    var(--color-border-interactive)
                ) !important;
                border-radius: var(--border-radius) !important;
                border: 2px solid var(--override-scrollbar-track-dark, var(--color-surface-2)) !important;
            }
            html.dark::-webkit-scrollbar-corner,
            html.dark body::-webkit-scrollbar-corner {
                background: var(--override-scrollbar-track-dark, var(--color-surface-2)) !important;
            }

            *::-webkit-scrollbar-thumb:hover {
                background: var(--color-hover-subtle, var(--color-scrollbar-thumb));
            }
        </style>
        <style id="buttons-radius-fix">
            #clearAllDataBtn,
            #resetUiBtn,
            .btn-destructive,
            .btn-destructive-all {
                border-radius: var(--border-radius) !important;
            }
        </style>
        <style>
            /* =================================================================== */
            /*    I. КОНФИГУРАЦИЯ И ГЛОБАЛЬНЫЕ СТИЛИ (Setup & Globals)           */
            /* =================================================================== */

            /* ----------------------------------- */
            /*         1.1. CSS Переменные         */
            /* ----------------------------------- */
            :root {
                /* Основной акцентный цвет */
                --color-primary-default: #5d5cde;
                --scrollbar-thumb-bg: var(--override-scrollbar-thumb-light, var(--color-border));
                --scrollbar-thumb-hover-bg: var(--color-hover-subtle, var(--color-border));
                --color-primary: var(--color-primary-default);

                --modal-backdrop-blur: 8px;

                /* Переменные для опасных действий */
                --color-red-text: #dc2626;
                --color-red-border: #fca5a5;
                --color-red-hover-bg: rgba(220, 38, 38, 0.1);

                /* Стили для подсветки текста при поиске */
                --search-highlight-text-bg-light: #fff352;
                --search-highlight-text-color-light: #333333;
                --search-highlight-text-bg-dark: #ffd700;
                --search-highlight-text-color-dark: #1a1a1a;

                /* Стили для подсветки блоков при поиске */
                --exact-match-border-color-light: #28a745;
                --exact-match-border-color-dark: #38c172;
                --element-highlight-bg-light: rgba(255, 220, 100, 0.2);
                --element-highlight-outline-light: rgba(255, 180, 50, 0.5);
                --element-highlight-bg-dark: rgba(184, 134, 11, 0.25);
                --element-highlight-outline-dark: rgba(218, 165, 32, 0.6);

                /* Стили для кастомного скроллбара */
                --scrollbar-track-color-light: rgba(0, 0, 0, 0.05);
                --scrollbar-track-color-dark: rgba(255, 255, 255, 0.05);
                --scrollbar-thumb-opacity: 0.65;
                --scrollbar-thumb-hover-opacity: 0.85;
                --scrollbar-thumb-bg: var(--override-scrollbar-thumb-light, var(--color-border));
                --scrollbar-thumb-hover-bg: var(--color-hover-subtle, var(--color-border));
                --scrollbar-thumb-bg: var(--override-scrollbar-thumb-light, var(--color-border));
                --scrollbar-thumb-hover-bg: var(--color-hover-subtle, var(--color-border));
            }

            @media (prefers-color-scheme: dark) {
                :root:not(.dark) {
                    --scrollbar-thumb-bg: var(
                        --override-scrollbar-thumb-dark,
                        rgba(255, 255, 255, 0.35)
                    );
                    --scrollbar-thumb-hover-bg: var(--color-hover-subtle, rgba(255, 255, 255, 0.5));
                    --scrollbar-track-color-light: var(
                        --override-scrollbar-track-dark,
                        rgba(255, 255, 255, 0.06)
                    );
                }
            }

            html.dark {
                --scrollbar-thumb-bg: var(
                    --override-scrollbar-thumb-dark,
                    var(--color-border-interactive)
                );
                --scrollbar-thumb-hover-bg: var(
                    --color-hover-subtle,
                    var(--color-border-interactive)
                );
            }

            /* ----------------------------------- */
            /*         1.2. Базовые стили          */
            /* ----------------------------------- */
            html {
                height: 100%;
            }

            body {
                display: flex;
                flex-direction: column;
                min-height: 100vh;
            }

            #appContent {
                flex-grow: 1;
            }

            /* =================================================================== */
            /*               II. КОМПОНЕНТЫ (Components)                         */
            /* =================================================================== */

            /* ----------------------------------- */
            /*        2.1. Модальные окна          */
            /* ----------------------------------- */
            body.modal-open {
                overflow: hidden;
            }

            #customizeUIModal .modal-inner-container {
                max-height: calc(100vh - 96px);
                max-width: min(920px, calc(100vw - 96px));
                display: flex;
                flex-direction: column;
            }
            @media (max-width: 640px) {
                #customizeUIModal .modal-inner-container {
                    max-height: calc(100vh - 64px);
                    max-width: calc(100vw - 32px);
                }
            }

            #customizeUIModal .-mx-6 {
                margin-left: 0 !important;
                margin-right: 0 !important;
            }
            #customizeUIModal .-mb-6 {
                margin-bottom: 0 !important;
            }
            #customizeUIModal .modal-inner-container .p-content.overflow-y-auto.flex-1 {
                flex: 1 1 auto;
                min-height: 0;
                overflow: auto;
            }

            div:has(> #clearClientDataBtn) {
                margin-left: 0 !important;
                margin-right: 0 !important;
                margin-bottom: 0 !important;
                border-bottom-left-radius: 0.5rem;
                border-bottom-right-radius: 0.5rem;
            }

            .modal-transition {
                transition-property: opacity, transform;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 200ms;
                opacity: 0;
                transform: scale(0.95);
            }

            .modal-visible {
                opacity: 1;
                transform: scale(1);
            }

            :is(
                    #algorithmModal,
                    #editModal,
                    #addModal,
                    #customizeUIModal,
                    #confirmClearDataModal,
                    #cibLinkModal,
                    #hotkeysModal,
                    #screenshotLightbox,
                    #screenshotViewerModal,
                    #noInnModal,
                    #addReglamentCategoryModal,
                    #foldersModal,
                    #reglamentModal,
                    #reglamentDetailModal,
                    #bookmarkModal,
                    #bookmarkDetailModal,
                    #extLinkModal,
                    #sedoFullscreenOverlay
                ) {
                pointer-events: none;
            }

            :is(
                    #algorithmModal,
                    #editModal,
                    #addModal,
                    #customizeUIModal,
                    #confirmClearDataModal,
                    #cibLinkModal,
                    #hotkeysModal,
                    #screenshotLightbox,
                    #screenshotViewerModal,
                    #noInnModal,
                    #addReglamentCategoryModal,
                    #foldersModal,
                    #reglamentModal,
                    #reglamentDetailModal,
                    #bookmarkModal,
                    #bookmarkDetailModal,
                    #extLinkModal,
                    #sedoFullscreenOverlay,
                    #extLinkCategoriesModal,

                ):not(.hidden) {
                pointer-events: auto;
            }

            :is(
                    #algorithmModal,
                    #editModal,
                    #addModal,
                    #customizeUIModal,
                    #confirmClearDataModal,
                    #cibLinkModal,
                    #hotkeysModal,
                    #screenshotLightbox,
                    #screenshotViewerModal,
                    #noInnModal,
                    #addReglamentCategoryModal,
                    #foldersModal,
                    #reglamentModal,
                    #reglamentDetailModal,
                    #bookmarkModal,
                    #bookmarkDetailModal,
                    #extLinkModal,
                    #sedoFullscreenOverlay,
                    #extLinkCategoriesModal,

                ):not(.hidden) {
                -webkit-backdrop-filter: blur(var(--modal-backdrop-blur)) !important;
                backdrop-filter: blur(var(--modal-backdrop-blur)) !important;
            }

            /* Стили для полноэкранного режима модальных окон */
            .is-fullscreen {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100vw !important;
                height: 100vh !important;
                max-width: none !important;
                max-height: none !important;
                z-index: 90 !important;
                padding: 0 !important;
                overflow: hidden !important;
            }

            .is-fullscreen > :is(.bg-white, .dark\:bg-gray-800) {
                border-radius: 0 !important;
                height: 100% !important;
                width: 100% !important;
                display: flex !important;
                flex-direction: column !important;
            }

            /* Обеспечиваем скроллинг контента в полноэкранном режиме */
            .is-fullscreen
                :is(
                    .modal-content-area-fullscreen-scroll,
                    #algorithmSteps,
                    #hotkeysModal .p-6.overflow-y-auto.flex-1,
                    #reglamentModal .modal-content-area,
                    #extLinkModal .modal-content-area,
                    #cibLinkModal .modal-content-area,
                    #bookmarkModal .p-content.overflow-y-auto.flex-1,
                    #bookmarkModal .modal-content-area,
                    #bookmarkDetailModal #bookmarkDetailOuterContent,
                    #addModal .p-content.overflow-y-auto.flex-1,
                    #editModal .p-content.overflow-y-auto.flex-1
                ) {
                flex-grow: 1;
                overflow-y: auto;
                min-height: 0;
            }

            .is-fullscreen .edit-step .step-desc {
                min-height: 150px;
            }

            /* ----------------------------------- */
            /*       2.2. Кастомный скроллбар      */
            /* ----------------------------------- */
            :is(
                    .custom-scrollbar,
                    html,
                    #searchResults,
                    .modal-content-area-fullscreen-scroll,
                    #algorithmSteps,
                    #hotkeysModal .p-6.overflow-y-auto.flex-1,
                    #reglamentModal .modal-content-area,
                    #reglamentDetailModal #reglamentDetailContent,
                    #extLinkModal .modal-content-area,
                    #cibLinkModal .modal-content-area,
                    #bookmarkModal .p-content.overflow-y-auto.flex-1,
                    #bookmarkDetailModal #bookmarkDetailOuterContent,
                    #addModal .p-content.overflow-y-auto.flex-1,
                    #editModal .p-content.overflow-y-auto.flex-1,
                    #customizeUIModal .p-content.overflow-y-auto.flex-1
                ) {
                scrollbar-width: thin;
                scrollbar-color: var(--scrollbar-thumb-bg) var(--scrollbar-track-color-light);
            }

            .dark
                :is(
                    .custom-scrollbar,
                    html,
                    #searchResults,
                    .modal-content-area-fullscreen-scroll,
                    #algorithmSteps,
                    #hotkeysModal .p-6.overflow-y-auto.flex-1,
                    #reglamentModal .modal-content-area,
                    #reglamentDetailModal #reglamentDetailContent,
                    #extLinkModal .modal-content-area,
                    #cibLinkModal .modal-content-area,
                    #bookmarkModal .p-content.overflow-y-auto.flex-1,
                    #bookmarkDetailModal #bookmarkDetailOuterContent,
                    #addModal .p-content.overflow-y-auto.flex-1,
                    #editModal .p-content.overflow-y-auto.flex-1,
                    #customizeUIModal .p-content.overflow-y-auto.flex-1
                ) {
                scrollbar-color: var(--scrollbar-thumb-bg) var(--scrollbar-track-color-dark);
            }

            :is(
                    .custom-scrollbar,
                    html,
                    #searchResults,
                    .modal-content-area-fullscreen-scroll,
                    #algorithmSteps,
                    #hotkeysModal .p-6.overflow-y-auto.flex-1,
                    #reglamentModal .modal-content-area,
                    #reglamentDetailModal #reglamentDetailContent,
                    #extLinkModal .modal-content-area,
                    #cibLinkModal .modal-content-area,
                    #bookmarkModal .p-content.overflow-y-auto.flex-1,
                    #bookmarkModal .modal-content-area,
                    #bookmarkDetailModal #bookmarkDetailOuterContent,
                    #addModal .p-content.overflow-y-auto.flex-1,
                    #editModal .p-content.overflow-y-auto.flex-1,
                    #customizeUIModal .p-content.overflow-y-auto.flex-1
                )::-webkit-scrollbar {
                width: 4px !important;
                height: 4px !important;
            }

            :is(
                    .custom-scrollbar,
                    html,
                    #searchResults,
                    .modal-content-area-fullscreen-scroll,
                    #algorithmSteps,
                    #hotkeysModal .p-6.overflow-y-auto.flex-1,
                    #reglamentModal .modal-content-area,
                    #reglamentDetailModal #reglamentDetailContent,
                    #extLinkModal .modal-content-area,
                    #cibLinkModal .modal-content-area,
                    #bookmarkModal .p-content.overflow-y-auto.flex-1,
                    #bookmarkDetailModal #bookmarkDetailOuterContent,
                    #addModal .p-content.overflow-y-auto.flex-1,
                    #editModal .p-content.overflow-y-auto.flex-1,
                    #customizeUIModal .p-content.overflow-y-auto.flex-1
                )::-webkit-scrollbar-track {
                background-color: var(--scrollbar-track-color-light);
                border-radius: 15px;
            }

            .dark
                :is(
                    .custom-scrollbar,
                    html,
                    #searchResults,
                    .modal-content-area-fullscreen-scroll,
                    #algorithmSteps,
                    #hotkeysModal .p-6.overflow-y-auto.flex-1,
                    #reglamentModal .modal-content-area,
                    #reglamentDetailModal #reglamentDetailContent,
                    #extLinkModal .modal-content-area,
                    #cibLinkModal .modal-content-area,
                    #bookmarkModal .p-content.overflow-y-auto.flex-1,
                    #bookmarkDetailModal #bookmarkDetailOuterContent,
                    #addModal .p-content.overflow-y-auto.flex-1,
                    #editModal .p-content.overflow-y-auto.flex-1,
                    #customizeUIModal .p-content.overflow-y-auto.flex-1
                )::-webkit-scrollbar-track {
                background-color: var(--scrollbar-track-color-dark);
            }

            :is(
                    .custom-scrollbar,
                    html,
                    #searchResults,
                    .modal-content-area-fullscreen-scroll,
                    #algorithmSteps,
                    #hotkeysModal .p-6.overflow-y-auto.flex-1,
                    #reglamentModal .modal-content-area,
                    #reglamentDetailModal #reglamentDetailContent,
                    #extLinkModal .modal-content-area,
                    #cibLinkModal .modal-content-area,
                    #bookmarkModal .p-content.overflow-y-auto.flex-1,
                    #bookmarkDetailModal #bookmarkDetailOuterContent,
                    #addModal .p-content.overflow-y-auto.flex-1,
                    #editModal .p-content.overflow-y-auto.flex-1,
                    #customizeUIModal .p-content.overflow-y-auto.flex-1
                )::-webkit-scrollbar-thumb {
                background-color: var(
                    --scrollbar-thumb-bg,
                    var(--override-scrollbar-thumb-dark, var(--color-border-interactive))
                ) !important;
                border-radius: 15px;
                border: 1px solid transparent !important;
                background-clip: content-box !important;
            }

            :is(
                    .custom-scrollbar,
                    html,
                    #searchResults,
                    .modal-content-area-fullscreen-scroll,
                    #algorithmSteps,
                    #hotkeysModal .p-6.overflow-y-auto.flex-1,
                    #reglamentModal .modal-content-area,
                    #reglamentDetailModal #reglamentDetailContent,
                    #extLinkModal .modal-content-area,
                    #cibLinkModal .modal-content-area,
                    #bookmarkModal .p-content.overflow-y-auto.flex-1,
                    #bookmarkDetailModal #bookmarkDetailOuterContent,
                    #addModal .p-content.overflow-y-auto.flex-1,
                    #editModal .p-content.overflow-y-auto.flex-1,
                    #customizeUIModal .p-content.overflow-y-auto.flex-1
                )::-webkit-scrollbar-thumb:hover {
                background-color: var(
                    --scrollbar-thumb-hover-bg,
                    var(
                        --color-hover-subtle,
                        var(--override-scrollbar-thumb-dark, var(--color-border))
                    )
                ) !important;
            }

            :is(
                    .custom-scrollbar,
                    html,
                    #searchResults,
                    .modal-content-area-fullscreen-scroll,
                    #algorithmSteps,
                    #hotkeysModal .p-6.overflow-y-auto.flex-1,
                    #reglamentModal .modal-content-area,
                    #reglamentDetailModal #reglamentDetailContent,
                    #extLinkModal .modal-content-area,
                    #cibLinkModal .modal-content-area,
                    #bookmarkModal .p-content.overflow-y-auto.flex-1,
                    #bookmarkDetailModal #bookmarkDetailOuterContent,
                    #addModal .p-content.overflow-y-auto.flex-1,
                    #editModal .p-content.overflow-y-auto.flex-1,
                    #customizeUIModal .p-content.overflow-y-auto.flex-1
                )::-webkit-scrollbar-corner {
                background: transparent;
            }

            #important-notifications-container.custom-scrollbar::-webkit-scrollbar {
                width: 8px;
            }

            #important-notifications-container.custom-scrollbar::-webkit-scrollbar-track {
                background: rgba(0, 0, 0, 0.1);
                border-radius: 4px;
            }

            #important-notifications-container.custom-scrollbar::-webkit-scrollbar-thumb {
                background: rgba(0, 0, 0, 0.3);
                border-radius: 4px;
            }

            #important-notifications-container.custom-scrollbar::-webkit-scrollbar-thumb:hover {
                background: rgba(0, 0, 0, 0.5);
            }

            .dark #important-notifications-container.custom-scrollbar::-webkit-scrollbar-track {
                background: rgba(255, 255, 255, 0.05);
            }

            .dark #important-notifications-container.custom-scrollbar::-webkit-scrollbar-thumb {
                background: rgba(255, 255, 255, 0.15);
            }

            .dark
                #important-notifications-container.custom-scrollbar::-webkit-scrollbar-thumb:hover {
                background: rgba(255, 255, 255, 0.25);
            }

            /* ----------------------------------- */
            /*             2.3. Табы               */
            /* ----------------------------------- */
            .tab-btn {
                transition: color 0.2s ease-in-out, border-color 0.2s ease-in-out;
                position: relative;
            }

            #clientNotes.custom-scrollbar::-webkit-scrollbar {
                width: 8px !important;
            }
            #clientNotes.custom-scrollbar::-webkit-scrollbar-thumb {
                border-width: 1px;
            }

            .tab-btn.tab-active {
                color: var(--color-primary) !important;
                border-bottom-color: var(--color-primary);
            }

            .tab-btn.tab-active > * {
                color: var(--color-primary) !important;
            }

            .tab-btn.tab-active i,
            .tab-btn.tab-active svg {
                color: var(--color-primary) !important;
            }

            #moreTabsDropdown a,
            #moreTabsDropdown .overflow-dropdown-item {
                text-decoration: none !important;
            }

            #moreTabsDropdown a:hover {
                text-decoration: none !important;
            }

            #appContent #moreTabsDropdown a,
            #appContent #moreTabsDropdown .overflow-dropdown-item {
                text-decoration: none !important;
            }
            #appContent #moreTabsDropdown a:hover {
                text-decoration: none !important;
            }

            .tab-btn.tab-active:hover {
                color: var(--color-primary) !important;
            }

            .tab-btn.tab-active:hover::before {
                transform: scaleY(0);
                opacity: 0;
                transition: none;
            }

            @media (min-width: 640px) {
                .tab-btn i {
                    margin-right: 0.35rem;
                }
            }

            .tab-content {
                transition: opacity 200ms ease-in-out;
            }

            .tab-content.is-hiding {
                opacity: 0;
            }

            :is(
                    #mainTab,
                    #programTab,
                    #linksTab,
                    #extLinksTab,
                    #skziTab,
                    #lk1cTab,
                    #webRegTab,
                    #reglamentsTab,
                    #bookmarksTab,
                    #sedoTypesTab
                ) {
                padding-left: 0.4rem;
                padding-right: 0.4rem;
            }

            /* ----------------------------------- */
            /*      2.4. Результаты поиска         */
            /* ----------------------------------- */
            #searchResults {
                transition: opacity 150ms ease-out, transform 150ms ease-out;
                opacity: 0;
                transform: translateY(-10px);
                pointer-events: none;
            }

            #searchResults:not(.hidden) {
                opacity: 1;
                transform: translateY(0);
                pointer-events: auto;
            }

            /* Подсветка точного совпадения */
            .exact-match-highlight {
                border-left: 4px solid var(--exact-match-border-color-light) !important;
                padding-left: calc(0.75rem - 4px);
                background-color: transparent !important;
            }

            .dark .exact-match-highlight,
            .dark .exact-match-highlight-dark {
                border-left-color: var(--exact-match-border-color-dark) !important;
            }

            .exact-match-highlight:hover {
                background-color: rgba(0, 0, 0, 0.03) !important;
            }

            .dark .exact-match-highlight:hover {
                background-color: rgba(255, 255, 255, 0.04) !important;
            }

            /* Активная подсветка элемента */
            .search-highlight-active {
                background-color: var(--element-highlight-bg-light) !important;
                outline: 2px solid var(--element-highlight-outline-light) !important;
                outline-offset: -2px;
                transition: background-color 0.3s ease-out, outline-color 0.3s ease-out;
                position: relative;
                z-index: 1;
            }

            .dark .search-highlight-active {
                background-color: var(--element-highlight-bg-dark) !important;
                outline-color: var(--element-highlight-outline-dark) !important;
            }

            /* Подсветка искомого текста */
            .search-term-highlight,
            mark {
                background-color: var(--search-highlight-text-bg-light);
                color: var(--search-highlight-text-color-light);
                padding: 0.08em 0.4em;
                border-radius: 0.15em;
                font-weight: 600;
                box-shadow: none;
            }

            .dark .search-term-highlight,
            .dark mark {
                background-color: var(--search-highlight-text-bg-dark);
                color: var(--search-highlight-text-color-dark);
            }

            .highlight-search-result-textarea {
                transition: box-shadow 0.3s ease-in-out;
                box-shadow: 0 0 8px 2px var(--color-primary, var(--color-primary-default));
            }

            /* ----------------------------------- */
            /*      2.5. Сортируемые списки        */
            /* ----------------------------------- */
            .my-sortable-ghost {
                background-color: #d1d5db;
                opacity: 0.75;
                border-radius: 0.375rem;
            }

            .dark .my-sortable-ghost {
                background-color: #4b5563;
            }

            .sortable-ghost {
                opacity: 0.4;
                background-color: #e0e7ff;
                border: 2px dashed var(--color-primary, #9333ea);
            }

            .sortable-drag {
                opacity: 0.95;
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
                transform: scale(1.02);
                cursor: grabbing;
            }

            .step-drag-handle {
                touch-action: none;
            }

            /* Сворачивание шагов */
            .edit-step .step-body {
                overflow: hidden;
                transition: max-height 0.35s ease-in-out, opacity 0.3s ease-in-out,
                    padding-top 0.35s ease-in-out, padding-bottom 0.35s ease-in-out,
                    margin-top 0.35s ease-in-out, border-top-width 0.35s ease-in-out;
                max-height: 2000px;
                opacity: 1;
                padding-top: 0.5rem;
            }

            .edit-step .step-toggle-icon {
                transition: transform 0.3s ease-in-out;
            }

            .edit-step.is-collapsed .step-body {
                max-height: 0;
                opacity: 0;
                padding-top: 0;
                padding-bottom: 0;
                margin-top: 0;
            }

            .edit-step.is-collapsed .step-toggle-icon {
                transform: rotate(-90deg);
            }

            .step-title-preview {
                pointer-events: none;
            }

            /* ----------------------------------- */
            /*         2.6. Color Picker           */
            /* ----------------------------------- */
            .color-swatch.ring-primary {
                --tw-ring-color: var(--color-primary, var(--color-primary-default));
            }

            :is(#hue-handle, #saturation-handle, #brightness-handle) {
                box-sizing: border-box;
                z-index: 10;
            }

            #color-preview-swatch {
                background-color: var(--color-primary, #9333ea);
            }

            #hue-slider-gradient {
                background: linear-gradient(
                    to right,
                    red 0%,
                    #ff0 17%,
                    lime 33%,
                    cyan 50%,
                    blue 67%,
                    #f0f 83%,
                    red 100%
                );
            }

            :is(#saturation-slider-gradient, #brightness-slider-gradient) {
                transition: background 0.1s ease-out;
            }

            /* ----------------------------------- */
            /*           2.7. Лайтбокс             */
            /* ----------------------------------- */
            #screenshotLightbox img {
                box-shadow: 0 0 25px rgba(0, 0, 0, 0.5);
            }

            /* ----------------------------------- */
            /*      2.8. Прочие компоненты         */
            /* ----------------------------------- */
            .reglament-item,
            .cib-link-item {
                cursor: pointer !important;
            }

            /* Таймер */
            .timer-segment {
                display: inline-block;
                min-width: 2ch;
                text-align: center;
                padding: 0.5rem;
                border-radius: 3px;
                cursor: pointer;
                transition: background-color 0.2s;
                vertical-align: baseline;
            }

            .timer-colon {
                display: inline-block;
                padding: 0 0.1ch;
                vertical-align: baseline;
                user-select: none;
            }

            .timer-segment:hover,
            .timer-segment:focus {
                background-color: rgba(0, 0, 0, 0.1);
            }

            .dark .timer-segment:hover,
            .dark .timer-segment:focus {
                background-color: rgba(255, 255, 255, 0.1);
            }

            input.timer-input-active {
                text-align: center;
                border: 1px solid var(--color-primary, #5d5cde);
                border-radius: 3px;
                padding: 0;
                min-width: 2ch;
                width: 2.1ch;
                box-sizing: border-box;
                background-color: var(--input-bg-color, #fff);
                color: var(--input-text-color, #000);
                vertical-align: baseline;
            }

            .dark input.timer-input-active {
                background-color: var(--input-bg-color-dark, #374151);
                color: var(--input-text-color-dark, #e5e7eb);
            }

            /* =================================================================== */
            /*              III. ДВИЖОК ТЕМИЗАЦИИ (Theming Engine)               */
            /* =================================================================== */

            /* ---------------------------------------------------- */
            /*      3.1. Адаптивная семантическая палитра           */
            /* ---------------------------------------------------- */
            /* Эти переменные используются стандартными темами и служат основой для кастомных */
            :root {
                /* --- DEFAULT LIGHT --- */
                --default-text-primary-light: #111827;
                --default-text-secondary-light: #4b5563;
                --default-text-placeholder-light: #9ca3af;
                --default-background-light: #f9fafb;
                --default-surface-1-light: #f3f4f6;
                --default-surface-2-light: #ffffff;
                --default-border-light: #d1d5db;
                --default-border-interactive-light: #d1d5db;
                --default-input-bg-light: #f9fafb;
                --default-hover-subtle-light: rgba(0, 0, 0, 0.055);

                /* --- USER OVERRIDES (LIGHT) — выставляются из JS при кастомизации --- */
                /* пример: document.documentElement.style.setProperty('--override-surface-1-light', '#ededed'); */
                /* по умолчанию не заданы, срабатывает fallback на default */

                /* --- FINAL TOKENS (LIGHT) --- */
                --color-text-primary: var(
                    --override-text-primary-light,
                    var(--default-text-primary-light)
                );
                --color-text-secondary: var(
                    --override-text-secondary-light,
                    var(--default-text-secondary-light)
                );
                --color-text-placeholder: var(
                    --override-text-placeholder-light,
                    var(--default-text-placeholder-light)
                );
                --color-background: var(
                    --override-background-light,
                    var(--default-background-light)
                );
                --color-surface-1: var(--override-surface-1-light, var(--default-surface-1-light));
                --color-surface-2: var(--override-surface-2-light, var(--default-surface-2-light));
                --color-border: var(--override-border-light, var(--default-border-light));
                --color-border-interactive: var(
                    --override-border-interactive-light,
                    var(--default-border-interactive-light)
                );
                --color-input-bg: var(--override-input-bg-light, var(--default-input-bg-light));
                --color-hover-subtle: var(
                    --override-hover-light,
                    var(--default-hover-subtle-light)
                );
            }

            .dark {
                /* --- DEFAULT DARK --- */
                --default-text-primary-dark: #f9fafb;
                --default-text-secondary-dark: #9ca3af;
                --default-text-placeholder-dark: #6b7280;
                --default-background-dark: #111827;
                --default-surface-1-dark: #1f2937;
                --default-surface-2-dark: #374151;
                --default-border-dark: #374151;
                --default-border-interactive-dark: #4b5563;
                --default-input-bg-dark: #374151;
                --default-hover-subtle-dark: rgba(255, 255, 255, 0.06);

                /* --- USER OVERRIDES (DARK) --- */
                /* пример: document.documentElement.style.setProperty('--override-surface-1-dark', '#263140'); */

                /* --- FINAL TOKENS (DARK) --- */
                --color-text-primary: var(
                    --override-text-primary-dark,
                    var(--default-text-primary-dark)
                );
                --color-text-secondary: var(
                    --override-text-secondary-dark,
                    var(--default-text-secondary-dark)
                );
                --color-text-placeholder: var(
                    --override-text-placeholder-dark,
                    var(--default-text-placeholder-dark)
                );
                --color-background: var(--override-background-dark, var(--default-background-dark));
                --color-surface-1: var(--override-surface-1-dark, var(--default-surface-1-dark));
                --color-surface-2: var(--override-surface-2-dark, var(--default-surface-2-dark));
                --color-border: var(--override-border-dark, var(--default-border-dark));
                --color-border-interactive: var(
                    --override-border-interactive-dark,
                    var(--default-border-interactive-dark)
                );
                --color-input-bg: var(--override-input-bg-dark, var(--default-input-bg-dark));
                --color-hover-subtle: var(--override-hover-dark, var(--default-hover-subtle-dark));
            }

            /* --- ГЛОБАЛЬНАЯ НОРМАЛИЗАЦИЯ НЕЙТРАЛЬНЫХ HOVER (всегда) --- */
            /* 1) Обычные hover:* */
            :where(
                    .hover\:bg-gray-50,
                    .hover\:bg-gray-100,
                    .hover\:bg-gray-200,
                    .hover\:bg-gray-300,
                    .hover\:bg-gray-400,
                    .hover\:bg-gray-500,
                    .hover\:bg-gray-600,
                    .hover\:bg-gray-700,
                    .hover\:bg-gray-700\/50,
                    .hover\:bg-gray-800\/50,
                    .hover\:bg-slate-700,
                    .hover\:bg-white\/10,
                    .hover\:bg-black\/10,
                    .dark\:hover\:bg-gray-500,
                    .dark\:hover\:bg-gray-600,
                    .dark\:hover\:bg-gray-700,
                    .dark\:hover\:bg-gray-700\/50,
                    .dark\:hover\:bg-gray-800\/50,
                    .dark\:hover\:bg-slate-700,
                    .dark\:hover\:bg-white\/10
                ):hover {
                background-color: var(--color-hover-subtle) !important;
            }
            /* 2) group-hover:* */
            .group:hover
                :where(
                    .group-hover\:bg-gray-50,
                    .group-hover\:bg-gray-100,
                    .group-hover\:bg-gray-200,
                    .group-hover\:bg-gray-700,
                    .group-hover\:bg-gray-800\/50,
                    .group-hover\:bg-slate-700,
                    .group-hover\:bg-white\/10,
                    .group-hover\:bg-black\/10,
                    .dark\:group-hover\:bg-gray-700,
                    .dark\:group-hover\:bg-gray-800\/50,
                    .dark\:group-hover\:bg-slate-700,
                    .dark\:group-hover\:bg-white\/10
                ) {
                background-color: var(--color-hover-subtle) !important;
            }

            /* ----------------------------------------------------------- */
            /*      3.2. Глобальные переопределения для кастомной темы     */
            /* ----------------------------------------------------------- */
            /* Этот блок активируется JS через класс .custom-background-active на body. */

            /* --- ОСНОВНОЙ ФОН И ТЕКСТ --- */
            body.custom-background-active .tab-btn.tab-active,
            .tab-btn.tab-active {
                color: var(--color-primary) !important;
            }
            body.custom-background-active .tab-btn.tab-active > *,
            .tab-btn.tab-active > * {
                color: var(--color-primary) !important;
            }
            .tab-btn.tab-active i,
            .tab-btn.tab-active svg {
                color: var(--color-primary) !important;
            }

            #appContent #moreTabsDropdown a,
            #appContent #moreTabsDropdown .overflow-dropdown-item {
                text-decoration: none !important;
            }
            #appContent #moreTabsDropdown a:hover {
                text-decoration: none !important;
            }

            #showFavoritesHeaderBtn,
            #timerToggleButton,
            #timerResetButton,
            #timerDecreaseButton,
            #timerIncreaseButton,
            #themeToggle,
            #clearSearchInputBtn,
            #customizeUIBtn,
            #exportDataBtn,
            #importDataBtn,
            #forceReloadBtn,
            #showHotkeysBtn {
                color: var(--color-primary) !important;
            }
            #showFavoritesHeaderBtn i,
            #timerToggleButton i,
            #timerResetButton i,
            #timerDecreaseButton i,
            #timerIncreaseButton i,
            #themeToggle i,
            #clearSearchInputBtn i,
            #customizeUIBtn i,
            #exportDataBtn i,
            #importDataBtn i,
            #forceReloadBtn i,
            #showHotkeysBtn i {
                color: var(--color-primary) !important;
            }

            #appSlogan {
                color: var(--color-primary) !important;
            }

            body.custom-background-active #clearClientDataBtn {
                background-color: var(--color-surface-2) !important;
                border: 1px solid var(--color-border) !important;
                color: var(--color-text-primary) !important;
            }

            #editMainBtn,
            #editMainBtn > * {
                background-color: var(--color-primary) !important;
                color: var(--color-text-primary) !important;
            }

            body.custom-background-active {
                color: var(--color-text-primary) !important;
                background-color: var(--color-background) !important;
            }

            body.custom-background-active
                :is(
                    h1,
                    h2,
                    h3,
                    h4,
                    h5,
                    h6,
                    p,
                    span,
                    a,
                    button,
                    li,
                    dt,
                    dd,
                    strong,
                    em,
                    small,
                    mark,
                    blockquote,
                    code,
                    kbd,
                    pre,
                    .text-gray-900,
                    .text-gray-800,
                    .text-gray-700,
                    .text-gray-600,
                    .dark\:text-gray-100,
                    .dark\:text-gray-200,
                    .dark\:text-gray-300
                ) {
                color: var(--color-text-primary) !important;
            }

            body.custom-background-active
                :is(.text-gray-600, .text-gray-500, .dark\:text-gray-300, .dark\:text-gray-400) {
                color: var(--color-text-secondary) !important;
            }

            /* --- ФОНЫ И ПОВЕРХНОСТИ (КОРРЕКТНАЯ ДВУХСЛОЙНАЯ СИСТЕМА) --- */
            /* --- СЛОЙ 1: Подложки, заголовки и менее важные фоны --- */
            body.custom-background-active
                :is(
                    .bg-gray-100,
                    .bg-gray-50,
                    .bg-gray-200,
                    .dark\:bg-slate-600,
                    .dark\:bg-gray-700,
                    .dark\:bg-gray-700\/50,
                    .dark\:bg-gray-700\/60,
                    .dark\:bg-gray-800,
                    #timerDisplay,
                    .cib-link-item code,
                    .edit-step .step-header,
                    .bg-gray-50.dark\:bg-gray-700,
                    #addModal .bg-gray-100.dark\:bg-gray-700,
                    #editModal .bg-gray-50.dark\:bg-gray-800,
                    #sedoFullscreenContent .bg-gray-50
                ) {
                background-color: var(--color-surface-1) !important;
            }

            /* --- СЛОЙ 2: Карточки, модальные окна, выпадающие меню (основной контент) --- */
            /* Для светлых и темных тем: используется семантическая переменная для основного контента. */
            body.custom-background-active
                :is(
                    .bg-white,
                    .dark\:bg-slate-800,
                    #blacklistTableContainer,
                    .google-doc-table > thead,
                    #moreTabsDropdown,
                    .tab-content > .p-4,
                    button.bg-gray-200,
                    button.bg-gray-300,
                    .modal-inner-container,
                    #algorithmModal .bg-white.dark\:bg-gray-800,
                    #addModal .bg-white.dark\:bg-gray-800,
                    #editModal .bg-white.dark\:bg-gray-800,
                    #customizeUIModal .bg-white.dark\:bg-gray-800,
                    #confirmClearDataModal .bg-white.dark\:bg-gray-800,
                    #cibLinkModal .bg-white.dark\:bg-gray-800,
                    #hotkeysModal .bg-white.dark\:bg-gray-800,
                    #noInnModal .bg-white.dark\:bg-gray-800,
                    #reglamentDetailModal .bg-white.dark\:bg-gray-800,
                    #bookmarkDetailModal .bg-white.dark\:bg-gray-800,
                    #extLinkModal .bg-white.dark\:bg-gray-800
                ) {
                background-color: var(--color-surface-2) !important;
            }

            .reglament-category {
                background-color: var(--color-surface-2) !important;
            }

            /* --- ГРАНИЦЫ И РАЗДЕЛИТЕЛИ --- */
            body.custom-background-active
                :is(
                    .border,
                    .border-t,
                    .border-r,
                    .border-b,
                    .border-l,
                    .border-gray-200,
                    .border-gray-300,
                    .dark\:border-gray-600,
                    .dark\:border-gray-700,
                    .dark\:border-slate-500,
                    .dark\:border-slate-600,
                    .divide-y > :not([hidden]) ~ :not([hidden]),
                    .divide-x > :not([hidden]) ~ :not([hidden]),
                    .google-doc-table th,
                    .google-doc-table td
                ) {
                border-color: var(--color-border) !important;
            }

            body.custom-background-active :is(.h-px.bg-gray-200, .h-px.dark\:bg-gray-700) {
                background-color: var(--color-border) !important;
            }
            body.custom-background-active :is(.bg-gray-200, .dark\:bg-slate-600) {
                background-color: var(--color-surface-1) !important;
            }

            /* --- ФОРМЫ (INPUT, TEXTAREA, SELECT) --- */
            body.custom-background-active :is(input, textarea, select) {
                background-color: var(--color-input-bg) !important;
                color: var(--color-text-primary) !important;
                border-color: var(--color-border-interactive) !important;
            }

            body.custom-background-active ::-webkit-input-placeholder {
                color: var(--color-text-secondary) !important;
                opacity: 1 !important;
            }

            body.custom-background-active ::-moz-placeholder {
                color: var(--color-text-secondary) !important;
                opacity: 1 !important;
            }

            body.custom-background-active :-ms-input-placeholder {
                color: var(--color-text-secondary) !important;
                opacity: 1 !important;
            }

            body.custom-background-active ::placeholder {
                color: var(--color-text-secondary) !important;
                opacity: 1 !important;
            }

            /* --- КНОПКИ --- */
            /* 1. Основные кнопки */
            body.custom-background-active
                :is(
                    #editSedoTypesBtn,
                    #addBlacklistEntryBtn,
                    #force-refresh-telefony-btn,
                    #force-refresh-shablony-btn,
                    #saveAlgorithmBtn,
                    #saveNewAlgorithmBtn,
                    #saveCibLinkBtn,
                    #addProgramAlgorithmBtn,
                    #addSkziAlgorithmBtn,
                    #addLk1cAlgorithmBtn,
                    #addWebRegAlgorithmBtn,
                    #addLinkBtn,
                    #addReglamentBtn,
                    #addBookmarkBtn,
                    #organizeBookmarksBtn,
                    #addExtLinkBtn,
                    #saveUISettingsBtn,
                    #sedoMainEditButton,
                    #editMainBtn,
                    button.bg-primary,
                    button:not([class*='bg-gray']):not([class*='bg-red']):not(
                            [class*='bg-transparent']
                        ):not(.tab-btn):not(.view-toggle):not(#timerDisplay button):not(
                            .btn-destructive
                        )
                ) {
                background-color: var(--color-primary);
                color: var(--color-text-primary) !important;
                box-shadow: none !important;
                transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            }

            /* Правило-гарант для иконок и вложенных элементов. */
            body.custom-background-active
                :is(
                    #editSedoTypesBtn,
                    #addBlacklistEntryBtn,
                    #force-refresh-telefony-btn,
                    #force-refresh-shablony-btn,
                    #saveAlgorithmBtn,
                    #saveNewAlgorithmBtn,
                    #saveCibLinkBtn,
                    #addProgramAlgorithmBtn,
                    #addSkziAlgorithmBtn,
                    #addLk1cAlgorithmBtn,
                    #addWebRegAlgorithmBtn,
                    #addLinkBtn,
                    #addReglamentBtn,
                    #addBookmarkBtn,
                    #organizeBookmarksBtn,
                    #addExtLinkBtn,
                    #saveUISettingsBtn,
                    #sedoMainEditButton,
                    #editMainBtn,
                    button.bg-primary,
                    button:not([class*='bg-gray']):not([class*='bg-red']):not(
                            [class*='bg-transparent']
                        ):not(.tab-btn):not(.view-toggle):not(#timerDisplay button):not(
                            .btn-destructive
                        )
                )
                > * {
                color: var(--color-text-primary) !important;
                transition: color 0.2s ease-in-out;
            }

            body.custom-background-active
                :is(
                    #editSedoTypesBtn,
                    #addBlacklistEntryBtn,
                    #force-refresh-telefony-btn,
                    #force-refresh-shablony-btn,
                    #saveAlgorithmBtn,
                    #saveNewAlgorithmBtn,
                    #saveCibLinkBtn,
                    #addProgramAlgorithmBtn,
                    #addSkziAlgorithmBtn,
                    #addLk1cAlgorithmBtn,
                    #addWebRegAlgorithmBtn,
                    #addLinkBtn,
                    #addReglamentBtn,
                    #addBookmarkBtn,
                    #organizeBookmarksBtn,
                    #addExtLinkBtn,
                    #saveUISettingsBtn,
                    #sedoMainEditButton,
                    #editMainBtn,
                    button.bg-primary,
                    button:not([class*='bg-gray']):not([class*='bg-red']):not(
                            [class*='bg-transparent']
                        ):not(.tab-btn):not(.view-toggle):not(#timerDisplay button):not(
                            .btn-destructive
                        )
                ):hover {
                background-color: var(--color-primary) !important;
                color: white !important;
            }

            #clearClientDataBtn {
                background-color: var(--color-surface-2) !important;
                border: 1px solid var(--color-border) !important;
                color: var(--color-text-primary) !important;
                box-shadow: none !important;
            }
            #clearClientDataBtn > * {
                color: var(--color-text-primary) !important;
            }
            #clearClientDataBtn:hover {
                background-color: var(--color-hover-subtle) !important;
                transition: background-color ease 0.3s;
            }

            /* Primary: Сохранить .txt */
            #exportTextBtn {
                background-color: var(--color-primary) !important;
                color: var(--color-text-primary) !important;
                border: none !important; /* гасим border-b из классов */
                box-shadow: none !important;
                transition: background-color ease 0.3s;
            }
            #exportTextBtn > * {
                color: var(--color-text-primary) !important;
            }
            #exportTextBtn:hover {
                background-color: var(--color-primary-hover) !important;
            }

            #resetUiBtn:hover {
                background-color: var(--color-hover-subtle);
                transition: background-color ease 0.3s;
            }

            #resetUiBtn {
                transition: background-color ease 0.3s;
            }

            #clearAllDataBtn {
                background-color: var(--color-red-hover-bg);
                padding: 0 1rem;
                transition: background-color ease 0.3s;
            }

            #clearAllDataBtn:hover {
                background-color: var(--color-red-text);
                transition: background-color ease 0.3s;
            }

            #confirmAndClearDataBtn {
                background-color: red;
            }

            body.custom-background-active
                :is(
                    #editSedoTypesBtn,
                    #addBlacklistEntryBtn,
                    #force-refresh-telefony-btn,
                    #force-refresh-shablony-btn,
                    #saveAlgorithmBtn,
                    #saveNewAlgorithmBtn,
                    #saveCibLinkBtn,
                    #addProgramAlgorithmBtn,
                    #addSkziAlgorithmBtn,
                    #addLk1cAlgorithmBtn,
                    #addWebRegAlgorithmBtn,
                    #addLinkBtn,
                    #addReglamentBtn,
                    #addBookmarkBtn,
                    #organizeBookmarksBtn,
                    #addExtLinkBtn,
                    #saveUISettingsBtn,
                    #sedoMainEditButton,
                    #editMainBtn,
                    button.bg-primary,
                    button:not([class*='bg-gray']):not([class*='bg-red']):not(
                            [class*='bg-transparent']
                        ):not(.tab-btn):not(.view-toggle):not(#timerDisplay button):not(
                            .btn-destructive
                        )
                ):hover
                > * {
                color: white !important;
            }

            /* 2. Второстепенные кнопки (Secondary Actions) - логика не меняется. */
            body.custom-background-active button:is(.bg-gray-200, .bg-gray-300, .bg-gray-100) {
                background-color: var(--color-surface-1) !important;
                color: var(--color-text-primary) !important;
                box-shadow: none !important;
            }

            body.custom-background-active
                button:is(.bg-gray-200, .bg-gray-300, .bg-gray-100):hover {
                background-color: var(--color-hover-subtle) !important;
            }

            /* 3. Опасные/Разрушительные кнопки (Destructive Actions) - ИСКЛЮЧЕНИЕ ИЗ ПРАВИЛ. */
            body.custom-background-active .btn-destructive,
            body.custom-background-active .btn-destructive > * {
                color: var(--color-red-text) !important;
            }

            body.custom-background-active .btn-destructive {
                background-color: transparent !important;
                border: 1px solid var(--color-red-border) !important;
                box-shadow: none !important;
                padding: 0.5rem 1rem;
            }

            body.custom-background-active .btn-destructive:hover {
                background-color: var(--color-red-hover-bg) !important;
                border-color: var(--color-red-text) !important;
            }

            .btn-destructive-all,
            .btn-destructive-all > * {
                color: white !important;
                border: none !important;
            }

            /* ===== Спец-исключения для модалки очистки данных ===== */
            body.custom-background-active #confirmClearDataModal #clearDataWarningBox {
                background-color: #fffbeb !important;
                border-color: #fde68a !important;
                color: #92400e !important;
            }
            html.dark body.custom-background-active #confirmClearDataModal #clearDataWarningBox {
                background-color: rgba(120, 53, 15, 0.5) !important;
                border-color: #92400e !important;
                color: #fde68a !important;
            }

            body.custom-background-active
                #confirmClearDataModal
                #clearDataWarningBox
                #exportBeforeClearBtn,
            html.dark
                body.custom-background-active
                #confirmClearDataModal
                #clearDataWarningBox
                #exportBeforeClearBtn {
                background: transparent !important;
                color: inherit !important;
                border: none !important;
                text-decoration: underline !important;
            }
            body.custom-background-active
                #confirmClearDataModal
                #clearDataWarningBox
                #exportBeforeClearBtn:hover {
                color: #7c2d12 !important;
            }
            html.dark
                body.custom-background-active
                #confirmClearDataModal
                #clearDataWarningBox
                #exportBeforeClearBtn:hover {
                color: #fde68a !important;
            }
            body.custom-background-active
                #confirmClearDataModal
                :is(h2 .fa-exclamation-triangle, .text-red-600, .dark\:text-red-500) {
                color: var(--color-red-text, #dc2626) !important;
            }
            body.custom-background-active #confirmClearDataModal #confirmAndClearDataBtn {
                background-color: var(--color-red-text, #dc2626) !important;
                color: #fff !important;
                border-color: var(--color-red-text, #dc2626) !important;
            }
            body.custom-background-active #confirmClearDataModal #confirmAndClearDataBtn:hover {
                background-color: var(--color-red-hover-bg, #ef4444) !important;
                border-color: var(--color-red-text, #dc2626) !important;
            }
            body.custom-background-active #confirmClearDataModal #cancelClearDataBtn {
                background-color: #e5e7eb !important;
                color: #374151 !important;
                border-color: #d1d5db !important;
            }
            html.dark body.custom-background-active #confirmClearDataModal #cancelClearDataBtn {
                background-color: #374151 !important;
                color: #e5e7eb !important;
                border-color: #4b5563 !important;
            }
            body.custom-background-active #confirmClearDataModal .bg-gray-50 {
                background-color: #f9fafb !important;
            }
            html.dark body.custom-background-active #confirmClearDataModal .dark\:bg-gray-700 {
                background-color: #374151 !important;
            }

            /* --- ССЫЛКИ --- */
            /* Правило для заголовков и элементов, которые не являются ссылками, но используют акцентный цвет */
            body.custom-background-active .text-primary {
                color: var(--color-primary) !important;
            }

            /* Правило для настоящих ссылок <a> */
            body.custom-background-active #appContent a {
                color: var(--color-text-primary) !important;
                text-decoration: underline !important;
                text-underline-offset: 3px;
                text-decoration-color: var(--color-primary) !important;
                transition: color 0.2s ease-in-out, text-decoration-color 0.2s ease-in-out;
            }

            body.custom-background-active #appContent a:hover {
                color: var(--color-primary) !important;
                text-decoration-color: var(--color-secondary) !important;
            }

            /* --- ТЕГИ И УВЕДОМЛЕНИЯ (ALERTS) --- */
            /* Адаптивные теги/метки */
            body.custom-background-active
                :is(
                    .bg-green-100,
                    .bg-yellow-100,
                    .bg-red-100,
                    .bg-blue-100,
                    .bg-purple-100,
                    .bg-indigo-100,
                    .bg-pink-100,
                    .bg-orange-100,
                    .bg-teal-100,
                    .bg-cyan-100,
                    .bg-amber-100,
                    .bg-lime-100,
                    .bg-emerald-100,
                    .bg-sky-100,
                    .dark\:bg-green-900,
                    .dark\:bg-yellow-900,
                    .dark\:bg-red-900,
                    .dark\:bg-blue-900,
                    .dark\:bg-purple-900,
                    .dark\:bg-indigo-900,
                    .dark\:bg-pink-900,
                    .dark\:bg-orange-900,
                    .dark\:bg-teal-900,
                    .dark\:bg-cyan-900,
                    .dark\:bg-amber-900,
                    .dark\:bg-lime-900,
                    .dark\:bg-emerald-900,
                    .dark\:bg-sky-900
                ) {
                background-color: var(--color-surface-1) !important;
                border: 1px solid var(--color-border) !important;
            }

            body.custom-background-active
                :is(
                    .text-green-800,
                    .text-yellow-800,
                    .text-red-800,
                    .text-blue-800,
                    .text-purple-800,
                    .text-indigo-800,
                    .text-pink-800,
                    .text-orange-800,
                    .text-teal-800,
                    .text-cyan-800,
                    .text-amber-800,
                    .text-lime-800,
                    .text-emerald-800,
                    .text-sky-800,
                    .dark\:text-green-200,
                    .dark\:text-yellow-200,
                    .dark\:text-red-200,
                    .dark\:text-blue-200,
                    .dark\:text-purple-200,
                    .dark\:text-indigo-200,
                    .dark\:text-pink-200,
                    .dark\:text-orange-200,
                    .dark\:text-teal-200,
                    .dark\:text-cyan-200,
                    .dark\:text-amber-200,
                    .dark\:text-lime-200,
                    .dark\:text-emerald-200,
                    .dark\:text-sky-200
                ) {
                color: var(--color-text-secondary) !important;
            }

            /* Адаптивные информационные панели (Alerts) */
            body.custom-background-active
                :is(
                    .bg-blue-50,
                    .dark\:bg-blue-900\/50,
                    .bg-yellow-50,
                    .dark\:bg-yellow-900\/50,
                    .bg-green-50,
                    .bg-red-50
                ) {
                background-color: var(--color-surface-2) !important;
                border-left-width: 4px;
            }

            body.custom-background-active
                :is(
                    .text-blue-800,
                    .dark\:text-blue-200,
                    .text-yellow-800,
                    .dark\:text-yellow-200,
                    .text-green-800,
                    .text-red-800
                ) {
                color: var(--color-text-primary) !important;
            }

            /* --- СПЕЦИФИЧЕСКИЕ КОМПОНЕНТЫ --- */
            /* Hover для блоков в "Шаблонах" */
            body.custom-background-active .shablony-block.copyable-block:hover {
                background-color: var(--color-hover-subtle) !important;
            }

            body.custom-background-active :is(nav, div):has(> .tab-btn) {
                background-color: transparent !important;
                box-shadow: none !important;
                border-bottom: none !important;
            }

            body.custom-background-active .force-transparent {
                background: transparent !important;
                background-color: transparent !important;
                box-shadow: none !important;
                border: none !important;
            }

            body.custom-background-active
                #customizeUIModal
                .p-content
                > div[class*='space-y']
                > div {
                background-color: transparent !important;
                box-shadow: none !important;
            }

            /* ---------------------------------------------------- */
            /*      3.3. Кастомное фоновое изображение              */
            /* ---------------------------------------------------- */
            body.custom-bg-image-active::before {
                content: '';
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                z-index: -1;
                background-image: var(--custom-background-image);
                background-size: contain;
                background-position: center center;
                background-repeat: no-repeat;
                background-attachment: fixed;
                background-color: var(--color-background);
            }

            body.custom-bg-image-active.theme-light-text::before {
                filter: brightness(0.6);
            }

            body.custom-bg-image-active.theme-dark-text::before {
                filter: brightness(1.5) contrast(0.9);
            }

            body.custom-bg-image-active {
                background-color: transparent !important;
            }

            #backgroundImagePreview {
                width: 128px;
                height: 72px;
                background-size: cover;
                background-position: center;
                background-repeat: no-repeat;
            }

            body.custom-background-active
                #customizeUIModal
                .p-content
                button:not(#saveUISettingsBtn):not(.btn-destructive) {
                background: transparent !important;
                background-color: transparent !important;
                box-shadow: none !important;
            }

            /* =================================================================== */
            /*           IV. УТИЛИТЫ И АНИМАЦИИ (Utilities & Animations)         */
            /* =================================================================== */

            /* ----------------------------------- */
            /*           4.1. Анимации             */
            /* ----------------------------------- */
            @keyframes pulse-highlight {
                0% {
                    transform: scale(1);
                    box-shadow: 0 0 0 0 rgba(255, 180, 50, 0.4);
                }

                50% {
                    transform: scale(1.01);
                    box-shadow: 0 0 3px 6px rgba(255, 180, 50, 0);
                }

                100% {
                    transform: scale(1);
                    box-shadow: 0 0 0 0 rgba(255, 180, 50, 0);
                }
            }

            .search-highlight-pulse {
                animation: pulse-highlight 1.3s ease-in-out;
            }

            @keyframes shake {
                10%,
                90% {
                    transform: translate3d(-1px, 0, 0);
                }

                20%,
                80% {
                    transform: translate3d(2px, 0, 0);
                }

                30%,
                50%,
                70% {
                    transform: translate3d(-4px, 0, 0);
                }

                40%,
                60% {
                    transform: translate3d(4px, 0, 0);
                }
            }

            .notification-updated-shake {
                animation: shake 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
                transform: translate3d(0, 0, 0);
            }

            /* ----------------------------------- */
            /*        4.2. Вспомогательные классы  */
            /* ----------------------------------- */
            #appContent.content-hidden-initial {
                opacity: 0;
                visibility: hidden;
            }

            #appContent.content-fading-in {
                opacity: 1;
                visibility: visible;
                transition: opacity 0.6s ease-in;
            }

            /* ----------------------------------- */
            /*             4.3. Копирайт           */
            /* ----------------------------------- */
            #app-copyright {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial,
                    sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
                color: #9ca3af;
                background-color: transparent;
                z-index: 10;
                transition: color 0.2s ease-in-out;
                padding-bottom: calc(0.5rem + env(safe-area-inset-bottom));
            }

            .dark #app-copyright {
                color: #4b5563;
            }

            #app-copyright a {
                color: inherit;
                text-decoration: none;
            }

            #app-copyright a:hover {
                text-decoration: underline;
                color: var(--color-primary, #5d5cde);
            }

            #showFavoritesHeaderBtn,
            #timerToggleButton,
            #timerResetButton,
            #timerDecreaseButton,
            #timerIncreaseButton,
            #themeToggle,
            #exportDataBtn,
            #importDataBtn,
            #forceReloadBtn,
            #showHotkeysBtn {
                color: var(--color-primary) !important;
            }
            #showFavoritesHeaderBtn i,
            #timerToggleButton i,
            #timerResetButton i,
            #timerDecreaseButton i,
            #timerIncreaseButton i,
            #themeToggle i,
            #exportDataBtn i,
            #importDataBtn i,
            #forceReloadBtn i,
            #showHotkeysBtn i {
                color: var(--color-primary) !important;
            }

            #editMainBtn,
            #editMainBtn > * {
                background-color: var(--color-primary) !important;
                color: var(--color-text-primary) !important;
            }

            :root:not(.dark) {
                --color-primary-hover: var(--color-secondary);
            }
            html.dark,
            :root.dark {
                --color-primary-hover: var(--color-secondary);
            }

            @supports (color: color-mix(in srgb, white, black)) {
                :root:not(.dark) {
                    --color-primary-hover: color-mix(in srgb, var(--color-primary) 80%, black);
                }
                html.dark,
                :root.dark {
                    --color-primary-hover: color-mix(in srgb, var(--color-primary) 80%, white);
                }
            }

            html:not(.dark) [class~='bg-primary']:hover,
            html.dark [class~='bg-primary']:hover {
                background-color: var(--color-primary-hover) !important;
            }

            /* ========================= Elevation / Тени уровней ========================= */
            /* Светлая тема: более насыщённые тени */
            :root:not(.dark) {
                --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.18), 0 0 0 1px rgba(0, 0, 0, 0.06);
                --shadow-md: 0 8px 16px rgba(0, 0, 0, 0.18), 0 2px 3px rgba(0, 0, 0, 0.12),
                    0 0 0 1px rgba(0, 0, 0, 0.05);
                --shadow-lg: 0 12px 24px rgba(0, 0, 0, 0.22), 0 6px 5px rgba(0, 0, 0, 0.14),
                    0 0 0 1px rgba(0, 0, 0, 0.04);
                --shadow-xl: 0 24px 48px rgba(0, 0, 0, 0.25), 0 12px 10px rgba(0, 0, 0, 0.16);
            }
            /* Тёмная тема: глубже тени + тонкий светлый контур для отделения от фона */
            html.dark,
            :root.dark {
                --shadow-sm: 0 1px 4px rgba(0, 0, 0, 0.463), 0 0 0 1px rgba(255, 255, 255, 0.08);
                --shadow-md: 0 8px 18px rgba(0, 0, 0, 0.3), 0 2px 15px rgba(0, 0, 0, 0.3),
                    0 0 0 1px rgba(255, 255, 255, 0.06);
                --shadow-lg: 0 14px 18px rgba(0, 0, 0, 0.486), 0 6px 14px rgba(0, 0, 0, 0.453),
                    0 0 0 1px rgba(255, 255, 255, 0.05);
                --shadow-xl: 0 28px 6px rgba(0, 0, 0, 0.5), 0 14px 8px rgba(0, 0, 0, 0.44),
                    0 0 0 1px rgba(255, 255, 255, 0.04);
            }
            /* Переопределяем стандартные shadow-классы Tailwind на семантические значения */
            .shadow-sm {
                box-shadow: var(--shadow-sm) !important;
            }
            .shadow-md {
                box-shadow: var(--shadow-md) !important;
            }
            .shadow-lg {
                box-shadow: var(--shadow-lg) !important;
            }
            .shadow-xl {
                box-shadow: var(--shadow-xl) !important;
            }

            .pdf-drop-overlay {
                padding: 8px;
                box-sizing: border-box;
                display: grid;
                place-items: center;
            }
            .pdf-drop-overlay .pdf-drop-msg {
                position: absolute;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
                max-width: calc(100% - 16px);
                text-align: center;
                white-space: normal;
                word-break: break-word;
                overflow-wrap: anywhere;
                line-height: 1.2;
                font-size: clamp(10px, 1.8vw, 14px);
            }
        </style>
    </head>

    <body
        class="bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-200"
    >
        <div class="container mx-auto px-4 py-6 max-w-7xl hidden" id="appContent">
            <header class="mb-4">
                <div class="flex flex-col md:flex-row justify-between md:items-start gap-4 mb-3">
                    <div>
                        <h1 class="text-2xl md:text-3xl font-bold text-primary">Copilot 1СО</h1>
                        <p id="appSlogan" class="text-sm md:text-base text-primary">
                            Ваш надежный второй пилот
                        </p>
                    </div>
                    <div
                        class="flex flex-wrap items-center justify-center md:justify-end gap-x-3 gap-y-2 w-full md:w-auto"
                    >
                        <div class="flex items-center gap-x-2">
                            <button
                                id="showFavoritesHeaderBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                title="Избранное"
                            >
                                <i class="fas fa-star hover:text-yellow-400"></i>
                            </button>

                            <div class="h-5 w-px bg-gray-300 dark:bg-gray-700 self-center"></div>

                            <div
                                id="appTimer"
                                class="flex items-center gap-1 text-sm flex-shrink-0"
                            >
                                <button
                                    id="timerToggleButton"
                                    title="Старт/Пауза"
                                    class="p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                >
                                    <i class="fas fa-play"></i>
                                </button>
                                <button
                                    id="timerResetButton"
                                    title="Сброс"
                                    class="p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                >
                                    <i class="fas fa-undo"></i>
                                </button>
                                <span
                                    id="timerDisplay"
                                    class="font-mono px-1 py-0.5 rounded bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 tabular-nums inline-flex items-baseline text-base"
                                >
                                </span>
                                <button
                                    id="timerDecreaseButton"
                                    title="Уменьшить на 1 мин"
                                    class="p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                >
                                    <i class="fas fa-minus"></i>
                                </button>
                                <button
                                    id="timerIncreaseButton"
                                    title="Увеличить на 1 мин"
                                    class="p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                >
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>

                        <button
                            id="themeToggle"
                            class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors flex-shrink-0"
                            title="Сменить тему"
                        >
                            <i class="fas fa-sun text-yellow-500 hidden dark:inline"></i>
                            <i class="fas fa-moon text-blue-300 dark:hidden"></i>
                        </button>
                        <div
                            class="relative w-full order-last sm:order-none sm:w-auto sm:min-w-[180px] md:w-[20rem] lg:w-[24rem]"
                        >
                            <input
                                type="text"
                                id="searchInput"
                                placeholder="Поиск..."
                                class="w-full pl-10 pr-10 py-2 rounded-lg bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                            />
                            <i
                                class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"
                            ></i>
                            <button
                                id="clearSearchInputBtn"
                                type="button"
                                class="absolute top-1/2 right-3 transform -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hidden"
                                title="Очистить поиск"
                            >
                                <i class="fas fa-times"></i>
                            </button>
                            <div
                                id="searchResults"
                                class="absolute z-50 top-full mt-1 left-0 right-0 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg hidden max-h-96 overflow-y-auto"
                            ></div>
                        </div>
                        <div class="flex gap-2 flex-shrink-0">
                            <button
                                id="customizeUIBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Настройки"
                            >
                                <i class="fas fa-cog"></i>
                            </button>
                            <button
                                id="exportDataBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Экспорт базы данных"
                            >
                                <i class="fas fa-upload"></i>
                            </button>
                            <button
                                id="importDataBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Импорт базы данных"
                            >
                                <i class="fas fa-download"></i>
                            </button>
                            <button
                                id="forceReloadBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Перезагрузка приложения"
                            >
                                <i class="fas fa-sync-alt"></i>
                            </button>
                            <button
                                id="showHotkeysBtn"
                                class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                title="Горячие клавиши и управление Copilot"
                            >
                                <i class="fas fa-info-circle"></i>
                            </button>
                            <input type="file" id="importFileInput" accept=".json" class="hidden" />
                        </div>
                    </div>
                </div>

                <div
                    id="advancedSearchOptions"
                    class="hidden bg-gray-100 dark:bg-gray-800 p-3 rounded-lg mb-3"
                >
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                        <div>
                            <label
                                class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                >Искать по:</label
                            >
                            <div class="flex flex-wrap gap-2">
                                <label class="inline-flex items-center">
                                    <input
                                        type="checkbox"
                                        checked
                                        class="search-field form-checkbox text-primary focus:ring-primary"
                                        value="title"
                                    />
                                    <span class="ml-2 text-gray-700 dark:text-gray-300"
                                        >Заголовок</span
                                    >
                                </label>
                                <label class="inline-flex items-center">
                                    <input
                                        type="checkbox"
                                        checked
                                        class="search-field form-checkbox text-primary focus:ring-primary"
                                        value="description"
                                    />
                                    <span class="ml-2 text-gray-700 dark:text-gray-300"
                                        >Описание/Содержимое</span
                                    >
                                </label>
                                <label class="inline-flex items-center">
                                    <input
                                        type="checkbox"
                                        checked
                                        class="search-field form-checkbox text-primary focus:ring-primary"
                                        value="steps"
                                    />
                                    <span class="ml-2 text-gray-700 dark:text-gray-300">Шаги</span>
                                </label>
                            </div>
                        </div>
                        <div class="flex justify-end items-end md:col-start-3">
                            <button
                                id="toggleAdvancedSearch"
                                class="px-3 py-1.5 text-sm bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-cog mr-1"></i>Параметры поиска
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Навигация по вкладкам -->
            <div class="mb-3 border-b border-gray-200 dark:border-gray-700">
                <nav class="flex flex-wrap -mb-px text-sm font-medium text-center">
                    <button
                        id="mainTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-home mr-1"></i>Главная
                    </button>
                    <button
                        id="programTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-desktop mr-1"></i>Программа 1С/УП
                    </button>
                    <button
                        id="linksTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-link mr-1"></i>Ссылки 1С
                    </button>
                    <button
                        id="extLinksTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-globe mr-1"></i>Внешние ресурсы
                    </button>
                    <button
                        id="skziTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-key mr-1"></i>СКЗИ
                    </button>
                    <button
                        id="lk1cTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-user-circle mr-1"></i>1СО ЛК
                    </button>
                    <button
                        id="webRegTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-plug mr-1"></i>Веб-Регистратор
                    </button>
                    <button
                        id="reglamentsTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-clipboard-list mr-1"></i>Регламенты
                    </button>
                    <button
                        id="bookmarksTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-bookmark mr-1"></i>Закладки
                    </button>
                    <button
                        id="sedoTypesTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-comments mr-1"></i>Типы СЭДО
                    </button>
                    <button
                        id="blacklistedClientsTab"
                        class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                    >
                        <i class="fas fa-user-secret mr-1"></i>
                        <span class="hidden sm:inline">Черный список жаб</span>
                    </button>
                    <div class="relative group ml-auto md:ml-1 shrink-0">
                        <button
                            id="moreTabsBtn"
                            class="tab-btn inline-block p-2.5 sm:p-3 rounded-t-lg border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-300 whitespace-nowrap text-sm sm:text-base"
                        >
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                        <div
                            id="moreTabsDropdown"
                            class="absolute hidden right-0 mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg z-10 w-48"
                        ></div>
                    </div>
                </nav>
            </div>

            <!-- Главная -->
            <div id="mainContent" class="tab-content">
                <div class="p-content rounded-lg shadow-md">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-content">
                        <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                            <div
                                class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-content-sm"
                            >
                                <h2 class="text-xl font-bold flex-shrink min-w-0">
                                    Главный алгоритм работы (значения можно редактировать под ваши
                                    нужды)
                                </h2>
                                <button
                                    id="editMainBtn"
                                    class="p-1.5 lg:px-3 lg:py-1.5 bg-primary hover:bg-secondary text-white rounded-md transition sm:self-start flex-shrink-0 border-b"
                                    title="Редактировать"
                                >
                                    <i class="fas fa-edit fa-xs lg:mr-1"></i>
                                    <span class="hidden lg:inline">Редактировать</span>
                                </button>
                            </div>
                            <div id="mainAlgorithm" class="space-y-content-sm">
                                <div
                                    class="algorithm-step bg-white dark:bg-gray-700 p-content-sm rounded-lg shadow-sm border-l-4 border-primary"
                                >
                                    <h3 class="font-bold text-base">Шаг 1: Приветствие</h3>
                                    <p class="text-sm">
                                        Поприветствуйте клиента, представьтесь, назовите компанию и
                                        спросите, чем можете помочь.
                                    </p>
                                    <p class="text-gray-600 dark:text-gray-400 mt-1 text-sm">
                                        Пример: "Добрый день! Техническая поддержка 1С-Отчетность,
                                        меня зовут [ваше имя]. Чем могу помочь?"
                                    </p>
                                </div>
                                <div
                                    class="algorithm-step bg-white dark:bg-gray-700 p-content-sm rounded-lg shadow-sm border-l-4 border-primary"
                                >
                                    <h3 class="font-bold text-base">Шаг 2: Уточнение ИНН</h3>
                                    <p class="text-sm">
                                        Запросите ИНН организации для идентификации клиента в
                                        системе.
                                    </p>
                                    <p class="text-gray-600 dark:text-gray-400 mt-1 text-sm">
                                        Пример: "Для начала работы, подскажите, пожалуйста, ИНН
                                        вашей организации."
                                    </p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1 italic">
                                        <a
                                            href="#"
                                            class="text-primary hover:underline"
                                            id="noInnLink"
                                            >Что делать, если клиент не может назвать ИНН?</a
                                        >
                                    </p>
                                </div>
                                <div
                                    class="algorithm-step bg-white dark:bg-gray-700 p-content-sm rounded-lg shadow-sm border-l-4 border-primary"
                                >
                                    <h3 class="font-bold text-base">
                                        Шаг 3: Идентификация проблемы
                                    </h3>
                                    <p class="text-sm">
                                        Выясните суть проблемы, задавая уточняющие вопросы.
                                    </p>
                                    <p class="text-gray-600 dark:text-gray-400 mt-1 text-sm">
                                        Примеры вопросов:
                                    </p>
                                    <ul
                                        class="list-disc list-inside pl-5 mt-1 text-gray-600 dark:text-gray-400 text-sm"
                                    >
                                        <li>
                                            <strong
                                                >Назовите, пожалуйста, полный текст ошибки</strong
                                            >
                                            (важно записать дословно)
                                        </li>
                                        <li>Когда впервые возникла проблема?</li>
                                    </ul>
                                </div>
                                <div
                                    class="algorithm-step bg-white dark:bg-gray-700 p-content-sm rounded-lg shadow-sm border-l-4 border-primary"
                                >
                                    <h3 class="font-bold text-base">Шаг 4: Решение проблемы</h3>
                                    <p class="text-sm">
                                        Определите категорию проблемы и перейдите к соответствующему
                                        разделу с инструкциями по решению.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-100 dark:bg-gray-800 p-content-sm rounded-lg shadow-md">
                            <div
                                class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-content-sm"
                            >
                                <h2 class="text-lg font-bold">Информация по обращению</h2>
                                <div class="flex justify-end gap-2 p-2">
                                    <button
                                        id="clearClientDataBtn"
                                        class="p-2 lg:px-3 lg:py-1.5 bg-primary hover:bg-secondary text-white rounded-md transition text-sm flex items-center border-b"
                                        title="Очистить"
                                    >
                                        <i class="fas fa-trash"></i>
                                        <span class="hidden lg:inline lg:ml-1">Очистить</span>
                                    </button>
                                </div>
                            </div>
                            <div
                                class="bg-white dark:bg-gray-700 p-1 rounded-lg shadow-sm overflow-hidden"
                            >
                                <textarea
                                    id="clientNotes"
                                    rows="20"
                                    placeholder="Здесь для удобства можно фиксировать всю информацию по обращению клиента..."
                                    class="w-full p-1 resize-none bg-gray-50 dark:bg-gray-800 border-0 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100 custom-scrollbar"
                                ></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Программа 1С/УП -->
            <div id="programContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Программа 1С/УП</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addProgramAlgorithmBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        id="programAlgorithms"
                        class="grid gap-content"
                        data-section-id="programAlgorithms"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <!-- СКЗИ -->
            <div id="skziContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">СКЗИ</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addSkziAlgorithmBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        id="skziAlgorithms"
                        class="grid gap-content"
                        data-section-id="skziAlgorithms"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <!-- 1СО ЛК -->
            <div id="lk1cContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">1СО ЛК (Личный кабинет)</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addLk1cAlgorithmBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        id="lk1cAlgorithms"
                        class="grid gap-content"
                        data-section-id="lk1cAlgorithms"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <!-- Веб-Регистратор -->
            <div id="webRegContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Веб-Регистратор</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addWebRegAlgorithmBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        id="webRegAlgorithms"
                        class="grid gap-content"
                        data-section-id="webRegAlgorithms"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <!-- Ссылки 1С -->
            <div id="linksContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Ссылки в программе 1С</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addLinkBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div
                        class="mb-content p-content-sm bg-blue-50 dark:bg-blue-900/50 border border-blue-200 dark:border-blue-700 rounded-lg text-sm text-blue-800 dark:text-blue-200"
                    >
                        <i class="fas fa-info-circle mr-1"></i> Это внутренние ссылки 1С (формат
                        `e1cib/...`). Используйте кнопку <i class="fas fa-copy"></i> для
                        копирования. В 1С скопированную ссылку можно вставить по комбинации клавиш
                        Shift + F11.
                    </div>
                    <div class="mb-content flex flex-col md:flex-row gap-content-sm relative">
                        <input
                            type="text"
                            id="linkSearchInput"
                            placeholder="Поиск по названию..."
                            class="flex-grow px-3 pr-10 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                        />
                        <button
                            id="clearLinkSearchInputBtn"
                            type="button"
                            class="absolute top-1/2 right-3 md:right-auto md:left-[calc(100%-2rem)] transform -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hidden"
                            title="Очистить поиск ссылок"
                        >
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <div
                        id="linksContainer"
                        class="flex flex-col"
                        data-section-id="linksContainer"
                        data-default-view="cards"
                    >
                        <div class="text-center py-6 text-gray-500 dark:text-gray-400">
                            Загрузка ссылок...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Регламенты -->
            <div id="reglamentsContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Регламенты</h2>
                        <div id="globalReglamentActionsBar" class="flex items-center space-x-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                                role="group"
                            >
                                <button
                                    type="button"
                                    class="view-toggle p-1.5 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-300"
                                    data-view="cards"
                                    title="Вид плитками"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    type="button"
                                    class="view-toggle p-1.5 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-300"
                                    data-view="list"
                                    title="Вид списком"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addReglamentBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md flex items-center justify-center whitespace-nowrap"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить регламент
                            </button>
                        </div>
                    </div>

                    <div
                        id="reglamentCategoryGrid"
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-content mb-content-lg"
                        data-section-id="reglamentCategoryGrid"
                        data-default-view="cards"
                    >
                        <div class="text-center py-6 text-gray-500 md:col-span-3">
                            Загрузка категорий...
                        </div>
                    </div>

                    <div id="reglamentsList" class="hidden">
                        <div
                            class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-content gap-3"
                        >
                            <div class="flex items-center">
                                <button
                                    id="backToCategories"
                                    class="p-2 mr-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 hover:text-primary transition-colors"
                                    title="Назад к категориям"
                                >
                                    <i class="fas fa-arrow-left"></i>
                                </button>
                                <h3 id="currentCategoryTitle" class="text-xl font-bold"></h3>
                            </div>
                        </div>
                        <div
                            id="reglamentsContainer"
                            class="auto-rows-fr"
                            data-section-id="reglamentsContainer"
                            data-default-view="list"
                        ></div>
                    </div>
                </div>
            </div>

            <!-- Закладки -->
            <div id="bookmarksContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div class="flex flex-col sm:flex-row justify-between items-center gap-4 mb-4">
                        <h2 class="text-2xl font-bold">Закладки</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                                role="group"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addBookmarkBtn"
                                class="px-3 py-1.5 bg-primary hover:bg-secondary text-white rounded-md transition flex items-center"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                            <button
                                id="organizeBookmarksBtn"
                                class="px-3 py-1.5 bg-primary hover:bg-secondary text-white rounded-md transition flex items-center"
                            >
                                <i class="fas fa-folder mr-2"></i>Управление папками
                            </button>
                        </div>
                    </div>

                    <div class="flex flex-col md:flex-row items-center gap-4 mb-4">
                        <div class="relative flex-grow w-full">
                            <label for="bookmarkSearchInput" class="sr-only"
                                >Поиск по закладкам</label
                            >
                            <input
                                type="text"
                                id="bookmarkSearchInput"
                                placeholder="Поиск по закладкам..."
                                class="w-full px-3 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                            />
                            <button
                                id="clearBookmarkSearchBtn"
                                type="button"
                                class="absolute top-1/2 right-3 transform -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hidden"
                                title="Очистить поиск по закладкам"
                            >
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="relative w-full md:w-auto">
                            <label for="bookmarkFolderFilter" class="sr-only"
                                >Фильтр по папкам</label
                            >
                            <select
                                id="bookmarkFolderFilter"
                                class="w-full md:w-auto pl-3 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 appearance-none"
                            >
                                <option value="">Все папки</option>
                            </select>
                            <div
                                class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none"
                            >
                                <i class="fas fa-chevron-down text-gray-400 text-xs"></i>
                            </div>
                        </div>
                    </div>

                    <div
                        id="bookmarksContainer"
                        class="grid gap-content"
                        data-section-id="bookmarksContainer"
                        data-default-view="cards"
                    >
                        <div
                            class="col-span-full text-center py-10 text-gray-500 dark:text-gray-400"
                        >
                            Закладки не найдены.
                        </div>
                    </div>
                </div>
            </div>

            <div id="sedoTypesContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold text-primary">Типы сообщений СЭДО</h2>
                        <div class="flex items-center gap-2 flex-wrap sm:flex-nowrap">
                            <button
                                id="editSedoTypesBtn"
                                class="px-3 py-1.5 text-sm bg-primary hover:bg-secondary text-white rounded-md transition flex items-center"
                            >
                                <i class="fas fa-edit mr-1.5"></i>Редактировать
                            </button>
                            <button
                                id="saveSedoTypesBtn"
                                class="px-3 py-1.5 text-sm bg-green-600 hover:bg-green-700 text-white rounded-md transition flex items-center"
                                style="display: none"
                            >
                                <i class="fas fa-save mr-1.5"></i>Сохранить
                            </button>
                            <button
                                id="cancelSedoTypesBtn"
                                class="px-3 py-1.5 text-sm bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 rounded-md transition"
                                style="display: none"
                            >
                                Отмена
                            </button>
                        </div>
                    </div>

                    <div id="sedoTypesInfoContainer" class="space-y-content"></div>
                </div>
            </div>

            <!-- Внешние ресурсы -->
            <div id="extLinksContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Внешние ресурсы</h2>
                        <div class="flex items-center gap-2 flex-wrap">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид карточек"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списка"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="addExtLinkBtn"
                                class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                            >
                                <i class="fas fa-plus mr-2"></i>Добавить
                            </button>
                        </div>
                    </div>
                    <div class="mb-content flex flex-col md:flex-row gap-content-sm">
                        <input
                            type="text"
                            id="extLinkSearchInput"
                            placeholder="Поиск по ресурсам..."
                            class="flex-grow px-3 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                        />
                        <select
                            id="extLinkCategoryFilter"
                            class="px-3 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100 md:max-w-xs"
                        >
                            <option value="">Все категории</option>
                        </select>
                    </div>
                    <div
                        id="extLinksContainer"
                        class="grid gap-content"
                        data-section-id="extLinksContainer"
                        data-default-view="cards"
                    ></div>
                </div>
            </div>

            <div id="blacklistedClientsContent" class="tab-content hidden p-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-semibold text-gray-800 dark:text-gray-200">
                        Черный список для жаб (но не говорите о нем <s>жабам</s> клиентам!)
                    </h2>
                    <button
                        id="addBlacklistEntryBtn"
                        class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md shadow-sm transition"
                    >
                        <i class="fas fa-plus mr-2"></i>Добавить
                    </button>
                </div>
                <div class="mb-4 flex items-center gap-2">
                    <label for="blacklistSearchInput" class="sr-only"
                        >Поиск по черному списку</label
                    >
                    <input
                        type="text"
                        id="blacklistSearchInput"
                        placeholder="Поиск по организации, ИНН, телефону, примечанию..."
                        class="flex-grow px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary text-sm"
                    />
                    <button
                        id="clearBlacklistSearchBtn"
                        title="Очистить поиск"
                        class="p-2 text-gray-500 hover:text-red-500 dark:text-gray-400 dark:hover:text-red-400 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 hidden"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div
                    id="blacklistTableContainer"
                    class="bg-white dark:bg-gray-800 shadow rounded-lg overflow-x-auto"
                >
                    <p class="text-gray-500 dark:text-gray-400 text-center py-4">
                        Загрузка данных...
                    </p>
                </div>
            </div>

            <!-- Модальные окна -->
            <div
                id="algorithmModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-7xl w-full">
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div
                                class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4"
                            >
                                <h2 id="modalTitle" class="text-2xl font-bold">
                                    Название алгоритма
                                </h2>
                                <div class="flex flex-wrap gap-2 justify-end flex-shrink-0">
                                    <button
                                        id="editAlgorithmBtn"
                                        class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition text-sm"
                                    >
                                        <i class="fas fa-edit mr-2"></i>Редактировать
                                    </button>
                                    <button
                                        id="deleteAlgorithmBtn"
                                        class="px-4 py-2 bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-md transition text-sm"
                                    >
                                        <i class="fas fa-trash mr-2"></i>Удалить
                                    </button>
                                    <button
                                        id="toggleFullscreenViewBtn"
                                        class="p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                        title="Развернуть на весь экран"
                                    >
                                        <i class="fas fa-expand"></i>
                                    </button>
                                    <button
                                        id="closeModalBtn"
                                        class="p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                        title="Закрыть"
                                    >
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div
                            id="algorithmSteps"
                            class="p-content space-y-content-sm overflow-y-auto max-h-[calc(90vh-150px)]"
                        ></div>
                    </div>
                </div>
            </div>

            <!-- Модальное окно Редактирование -->
            <div
                id="editModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 p-4 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div
                        class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-5xl w-full max-h-[95vh] flex flex-col"
                    >
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <h2 id="editModalTitle" class="text-2xl font-bold">
                                    Редактирование алгоритма
                                </h2>
                                <div class="flex items-center gap-2 justify-end flex-shrink-0">
                                    <button
                                        id="toggleFullscreenEditBtn"
                                        class="inline-block p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors align-middle"
                                        title="Развернуть на весь экран"
                                    >
                                        <i class="fas fa-expand"></i>
                                    </button>
                                    <button
                                        id="closeEditModalBtn"
                                        class="inline-block p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors align-middle"
                                        title="Закрыть"
                                    >
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="p-content overflow-y-auto flex-1 bg-gray-50 dark:bg-gray-800">
                            <div class="mb-4">
                                <label
                                    for="algorithmTitle"
                                    class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                    >Название алгоритма</label
                                >
                                <input
                                    type="text"
                                    id="algorithmTitle"
                                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                                />
                            </div>
                            <div class="mb-4" id="algorithmDescriptionContainer">
                                <label
                                    for="algorithmDescription"
                                    class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                    >Краткое описание</label
                                >
                                <textarea
                                    id="algorithmDescription"
                                    rows="3"
                                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                                ></textarea>
                            </div>
                            <h3 class="text-xl font-bold mb-3 text-gray-800 dark:text-gray-200">
                                Шаги
                            </h3>
                            <div id="editSteps" class="space-y-4"></div>
                            <div class="mt-4">
                                <button
                                    id="addStepBtn"
                                    class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                >
                                    <i class="fas fa-plus mr-2"></i>Добавить шаг
                                </button>
                            </div>
                        </div>
                        <div
                            class="p-content border-t border-gray-200 dark:border-gray-600 mt-auto"
                        >
                            <div class="flex justify-end items-center gap-2">
                                <button
                                    id="cancelEditBtn"
                                    class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 rounded-md transition"
                                >
                                    Отмена
                                </button>
                                <button
                                    id="saveAlgorithmBtn"
                                    class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                >
                                    <i class="fas fa-save mr-1"></i> Сохранить изменения
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div
                id="addModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 p-4 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div
                        class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col"
                    >
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <h2 id="addModalTitle" class="text-2xl font-bold">
                                    Новый алгоритм
                                </h2>
                                <div>
                                    <button
                                        id="toggleFullscreenAddBtn"
                                        class="inline-block p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors align-middle"
                                        title="Развернуть на весь экран"
                                    >
                                        <i class="fas fa-expand"></i>
                                    </button>
                                    <button
                                        id="closeAddModalBtn"
                                        class="inline-block p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors align-middle"
                                        title="Закрыть"
                                    >
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="p-content overflow-y-auto flex-1 bg-gray-100 dark:bg-gray-700">
                            <div class="mb-4">
                                <label
                                    for="newAlgorithmTitle"
                                    class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                    >Название алгоритма</label
                                >
                                <input
                                    type="text"
                                    id="newAlgorithmTitle"
                                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"
                                />
                            </div>
                            <div class="mb-4">
                                <label
                                    for="newAlgorithmDesc"
                                    class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                    >Краткое описание</label
                                >
                                <textarea
                                    id="newAlgorithmDesc"
                                    rows="3"
                                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"
                                ></textarea>
                            </div>

                            <div id="newSteps" class="space-y-4"></div>

                            <div class="mt-4">
                                <button
                                    id="addNewStepBtn"
                                    class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                >
                                    <i class="fas fa-plus mr-2"></i>Добавить шаг
                                </button>
                            </div>
                        </div>

                        <div
                            class="p-content border-t border-gray-200 dark:border-gray-600 mt-auto"
                        >
                            <div class="flex justify-end gap-2">
                                <button
                                    id="cancelAddBtn"
                                    class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 rounded-md transition"
                                >
                                    Отмена
                                </button>
                                <button
                                    id="saveNewAlgorithmBtn"
                                    class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                >
                                    Сохранить
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Модальное окно Настройки UI -->
            <div
                id="customizeUIModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 p-4 overflow-y-auto flex items-center justify-center hidden"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div
                        class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-7xl w-full max-h-screen flex flex-col modal-inner-container overflow-hidden"
                    >
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center gap-4">
                                <h2 class="text-2xl font-bold">Настройки</h2>
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <span
                                            id="employeeExtensionDisplay"
                                            class="inline-block px-4 py-2 text-base border-2 border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors min-w-[180px] text-center align-middle"
                                            title="Клик для редактирования"
                                        >
                                        </span>
                                        <input
                                            type="text"
                                            id="employeeExtensionInput"
                                            class="inline-block px-4 py-2 text-base border-2 border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-900 hidden min-w-[180px] align-middle"
                                            maxlength="4"
                                            pattern="\d*"
                                            title="Введите доб. номер"
                                        />
                                    </div>
                                    <button
                                        id="closeCustomizeUIModalBtn"
                                        class="p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                        title="Закрыть"
                                    >
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="p-content overflow-y-auto flex-1">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-content-lg">
                                <div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Ориентация главного экрана</label
                                        >
                                        <div class="flex space-x-3 mt-2">
                                            <label class="flex items-center">
                                                <input
                                                    type="radio"
                                                    name="mainLayout"
                                                    value="horizontal"
                                                    class="form-radio text-primary focus:ring-primary mr-2"
                                                    checked
                                                />
                                                <span class="text-gray-700 dark:text-gray-300"
                                                    >Горизонтальная</span
                                                >
                                            </label>
                                            <label class="flex items-center">
                                                <input
                                                    type="radio"
                                                    name="mainLayout"
                                                    value="vertical"
                                                    class="form-radio text-primary focus:ring-primary mr-2"
                                                />
                                                <span class="text-gray-700 dark:text-gray-300"
                                                    >Вертикальная</span
                                                >
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Управление разделами (вкладками)</label
                                        >
                                        <div class="space-y-2 mt-2">
                                            <div id="panelSortContainer" class="space-y-2"></div>
                                            <p
                                                class="text-xs text-gray-500 dark:text-gray-400 mt-2"
                                            >
                                                * Перетаскивайте элементы для изменения порядка
                                                вкладок
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h3
                                        class="text-lg font-semibold mb-content-sm text-gray-900 dark:text-gray-100"
                                    >
                                        Настройка цветов элементов (БЕТА)
                                    </h3>
                                    <div
                                        class="flex justify-between flex-wrap space-x-4"
                                        id="colorTargetSelector"
                                    >
                                        <label class="flex items-center cursor-pointer">
                                            <input
                                                type="radio"
                                                name="colorTarget"
                                                value="elements"
                                                class="form-radio text-primary focus:ring-primary"
                                                checked
                                            />
                                            <span
                                                class="ml-2 text-gray-700 dark:text-gray-300 font-medium"
                                                >ЦВЕТ ЭЛЕМЕНТОВ</span
                                            >
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input
                                                type="radio"
                                                name="colorTarget"
                                                value="background"
                                                class="form-radio text-primary focus:ring-primary"
                                            />
                                            <span
                                                class="ml-2 text-gray-700 dark:text-gray-300 font-medium"
                                                >ЦВЕТ ФОНА</span
                                            >
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input
                                                type="radio"
                                                name="colorTarget"
                                                value="text"
                                                class="form-radio text-primary focus:ring-primary"
                                            />
                                            <span
                                                class="ml-2 text-gray-700 dark:text-gray-300 font-medium"
                                                >ЦВЕТ ТЕКСТА</span
                                            >
                                        </label>
                                    </div>
                                    <div class="mb-content" id="advancedColorPicker">
                                        <div class="flex items-center justify-center mt-2 mb-4">
                                            <div
                                                id="color-preview-swatch"
                                                class="w-20 h-20 rounded-lg border-4 border-white dark:border-gray-700 shadow-inner"
                                            ></div>
                                        </div>

                                        <div class="space-y-3 mt-4">
                                            <div>
                                                <div
                                                    class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-1"
                                                >
                                                    <label for="hue-value">Цвет</label>
                                                    <input
                                                        id="hue-value"
                                                        type="text"
                                                        readonly
                                                        class="w-16 text-center bg-gray-100 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600 rounded text-sm py-0.5"
                                                    />
                                                </div>
                                                <div
                                                    id="hue-slider"
                                                    class="relative w-full h-4 rounded-full cursor-pointer p-0.5 bg-gray-200 dark:bg-gray-700"
                                                >
                                                    <div
                                                        class="w-full h-full rounded-full overflow-hidden"
                                                    >
                                                        <div
                                                            id="hue-slider-gradient"
                                                            class="w-full h-full"
                                                        ></div>
                                                    </div>
                                                    <div
                                                        id="hue-handle"
                                                        class="absolute w-5 h-5 -mt-2.5 top-1/2 rounded-full border-2 border-white shadow-md bg-transparent pointer-events-none"
                                                        style="left: 0%"
                                                    ></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div
                                                    class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-1"
                                                >
                                                    <label for="saturation-value"
                                                        >Насыщенность</label
                                                    >
                                                    <input
                                                        id="saturation-value"
                                                        type="text"
                                                        readonly
                                                        class="w-16 text-center bg-gray-100 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600 rounded text-sm py-0.5"
                                                    />
                                                </div>
                                                <div
                                                    id="saturation-slider"
                                                    class="relative w-full h-4 rounded-full cursor-pointer p-0.5 bg-gray-200 dark:bg-gray-700"
                                                >
                                                    <div
                                                        class="w-full h-full rounded-full overflow-hidden"
                                                    >
                                                        <div
                                                            id="saturation-slider-gradient"
                                                            class="w-full h-full"
                                                        ></div>
                                                    </div>
                                                    <div
                                                        id="saturation-handle"
                                                        class="absolute w-5 h-5 -mt-2.5 top-1/2 rounded-full border-2 border-white shadow-md pointer-events-none"
                                                        style="left: 80%"
                                                    ></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div
                                                    class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-1"
                                                >
                                                    <label for="brightness-value">Яркость</label>
                                                    <input
                                                        id="brightness-value"
                                                        type="text"
                                                        readonly
                                                        class="w-16 text-center bg-gray-100 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600 rounded text-sm py-0.5"
                                                    />
                                                </div>
                                                <div
                                                    id="brightness-slider"
                                                    class="relative w-full h-4 rounded-full cursor-pointer p-0.5 bg-gray-200 dark:bg-gray-700"
                                                >
                                                    <div
                                                        class="w-full h-full rounded-full overflow-hidden"
                                                    >
                                                        <div
                                                            id="brightness-slider-gradient"
                                                            class="w-full h-full"
                                                        ></div>
                                                    </div>
                                                    <div
                                                        id="brightness-handle"
                                                        class="absolute w-5 h-5 -mt-2.5 top-1/2 rounded-full border-2 border-white shadow-md pointer-events-none"
                                                        style="left: 88%"
                                                    ></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Режим темы</label
                                        >
                                        <div class="flex space-x-3 mt-2">
                                            <label class="flex items-center">
                                                <input
                                                    type="radio"
                                                    name="themeMode"
                                                    value="light"
                                                    class="form-radio text-primary focus:ring-primary mr-2"
                                                />
                                                <span class="text-gray-700 dark:text-gray-300"
                                                    >Светлая</span
                                                >
                                            </label>
                                            <label class="flex items-center">
                                                <input
                                                    type="radio"
                                                    name="themeMode"
                                                    value="dark"
                                                    class="form-radio text-primary focus:ring-primary mr-2"
                                                />
                                                <span class="text-gray-700 dark:text-gray-300"
                                                    >Темная</span
                                                >
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Масштаб</label
                                        >
                                        <div class="flex items-center space-x-3 mt-2">
                                            <button
                                                id="decreaseFontBtn"
                                                class="p-1.5 rounded border border-gray-300 dark:border-gray-600 focus:outline-none text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                            >
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <span
                                                id="fontSizeLabel"
                                                class="text-gray-700 dark:text-gray-300"
                                                >100%</span
                                            >
                                            <button
                                                id="increaseFontBtn"
                                                class="p-1.5 rounded border border-gray-300 dark:border-gray-600 focus:outline-none text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                            >
                                                <i class="fas fa-plus"></i>
                                            </button>
                                            <button
                                                id="resetFontBtn"
                                                class="ml-2 text-xs text-primary hover:underline focus:outline-none focus:ring-2 focus:ring-primary rounded"
                                            >
                                                Сбросить на 100%
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Скругление углов</label
                                        >
                                        <input
                                            type="range"
                                            min="0"
                                            max="20"
                                            value="8"
                                            class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary"
                                            id="borderRadiusSlider"
                                        />
                                        <div
                                            class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1"
                                        >
                                            <span>Квадратные</span>
                                            <span>Скругленные</span>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Настройка отступов</label
                                        >
                                        <input
                                            type="range"
                                            min="0"
                                            max="6"
                                            value="3"
                                            class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary"
                                            id="densitySlider"
                                        />
                                        <div
                                            class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1"
                                        >
                                            <span>Меньше</span>
                                            <span>Больше</span>
                                        </div>
                                    </div>
                                    <div class="mb-content">
                                        <label
                                            class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                            >Фоновое изображение</label
                                        >
                                        <div class="flex items-center gap-4 mt-2">
                                            <div
                                                id="backgroundImagePreview"
                                                class="rounded-md bg-gray-200 dark:bg-gray-700/50 border border-gray-300 dark:border-gray-600 flex-shrink-0 flex items-center justify-center"
                                            >
                                                <span
                                                    id="backgroundImagePreviewText"
                                                    class="text-xs text-gray-500 dark:text-gray-400 p-2 text-center"
                                                    >Нет изображения</span
                                                >
                                            </div>
                                            <div class="flex flex-col gap-2">
                                                <button
                                                    type="button"
                                                    id="backgroundImageUploadBtn"
                                                    class="px-3 py-1.5 text-sm bg-primary hover:bg-secondary text-white rounded-md transition"
                                                >
                                                    <i class="fas fa-upload mr-2"></i>Загрузить...
                                                </button>
                                                <button
                                                    type="button"
                                                    id="backgroundImageRemoveBtn"
                                                    class="px-3 py-1.5 text-sm bg-red-600 hover:bg-red-700 text-white rounded-md transition hidden"
                                                >
                                                    <i class="fas fa-trash mr-2"></i>Удалить
                                                </button>
                                                <input
                                                    type="file"
                                                    id="backgroundImageInput"
                                                    class="hidden"
                                                    accept="image/png, image/jpeg, image/gif, image/webp"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="space-y-content-sm border-t border-gray-200 dark:border-gray-600 pt-content-sm mt-content-lg px-content-sm pb-content-sm rounded-b-lg"
                                        id="additionalSecuritySettingsSection"
                                    >
                                        <div>
                                            <label
                                                for="toggleBlacklistWarning"
                                                class="flex items-center cursor-pointer"
                                            >
                                                <input
                                                    type="checkbox"
                                                    id="toggleBlacklistWarning"
                                                    name="showBlacklistUsageWarning"
                                                    class="form-checkbox h-5 w-5 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded"
                                                />
                                                <span
                                                    class="ml-3 text-sm text-gray-700 dark:text-gray-300"
                                                    >Всегда показывать предупреждение при входе в
                                                    раздел ЧС</span
                                                >
                                            </label>
                                            <p
                                                class="text-xs text-gray-500 dark:text-gray-400 mt-1 pl-8"
                                            >
                                                Если эта опция отключена, вы не будете видеть
                                                страницу с предупреждением каждый раз при переходе в
                                                раздел "Черный список".
                                            </p>
                                        </div>

                                        <div
                                            class="pt-content-sm border-t border-gray-200 dark:border-gray-600"
                                            id="uiImportSettingsSection"
                                        >
                                            <label
                                                for="toggleDisableForcedBackup"
                                                class="flex items-center cursor-pointer"
                                            >
                                                <input
                                                    type="checkbox"
                                                    id="toggleDisableForcedBackup"
                                                    name="disableForcedBackupOnImport"
                                                    class="form-checkbox h-5 w-5 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded"
                                                />
                                                <span
                                                    class="ml-3 text-sm text-gray-700 dark:text-gray-300"
                                                    >Отключить принудительный бэкап при импорте
                                                    базы</span
                                                >
                                            </label>
                                            <p
                                                class="text-xs text-gray-500 dark:text-gray-400 mt-1 pl-8"
                                            >
                                                Если эта опция включена, приложение не будет
                                                автоматически создавать резервную копию текущей базы
                                                данных перед импортом новой. Используйте с
                                                осторожностью.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div
                            class="p-content border-t border-gray-200 dark:border-gray-700 mt-auto bg-gray-50 dark:bg-gray-700 -mx-6 -mb-6 rounded-b-lg"
                        >
                            <div class="flex justify-between gap-2 flex-wrap">
                                <button
                                    id="clearAllDataBtn"
                                    class="btn-destructive btn-destructive-all"
                                >
                                    <i class="fas fa-skull-crossbones mr-2"></i>Очистить все данные
                                </button>
                                <button
                                    id="resetUiBtn"
                                    class="btn-secondary btn-destructive border-b p-2"
                                >
                                    Сбросить настройки интерфейса
                                </button>
                                <div class="flex gap-2">
                                    <button
                                        id="cancelUISettingsBtn"
                                        class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md transition"
                                    >
                                        Отмена
                                    </button>
                                    <button
                                        id="saveUISettingsBtn"
                                        class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                    >
                                        Сохранить
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Модальное окно подтверждения очистки данных -->
            <div
                id="confirmClearDataModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-[60] p-4 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full">
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <h2 class="text-xl font-bold text-red-600 dark:text-red-500">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>Подтвердите
                                    очистку данных
                                </h2>
                                <button
                                    class="close-confirm-clear-modal p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                    title="Закрыть"
                                >
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>
                        </div>
                        <div class="p-content space-y-4">
                            <p class="text-base text-gray-700 dark:text-gray-300 text-lg">
                                Вы уверены, что хотите
                                <strong class="text-red-600 dark:text-red-500"
                                    >полностью удалить все данные</strong
                                >
                                приложения (алгоритмы, настройки, заметки, закладки, ссылки,
                                регламенты - всё, что вы вносили)?
                            </p>
                            <p class="text-lg font-semibold text-red-600 dark:text-red-500">
                                Это действие необратимо!
                            </p>
                            <div
                                id="clearDataWarningBox"
                                class="bg-yellow-50 dark:bg-yellow-900/50 border border-yellow-200 dark:border-yellow-700 rounded-lg p-3 text-lg text-yellow-800 dark:text-yellow-200"
                            >
                                <i class="fas fa-info-circle mr-1"></i> Рекомендуется
                                <button
                                    id="exportBeforeClearBtn"
                                    class="font-medium underline hover:text-yellow-900 dark:hover:text-yellow-100 focus:outline-none"
                                >
                                    сначала экспортировать ваши данные
                                </button>
                                в файл на случай, если они понадобятся в будущем.
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">
                                После очистки приложение будет перезагружено со стандартными
                                настройками и данными. Повторная индексация базы данных после
                                очистки может занимать некоторое время.
                            </p>
                        </div>
                        <div
                            class="p-content border-t border-gray-200 dark:border-gray-700 mt-auto bg-gray-50 dark:bg-gray-700 rounded-b-lg"
                        >
                            <div class="flex justify-end gap-3">
                                <button
                                    id="cancelClearDataBtn"
                                    class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md transition border"
                                >
                                    Отмена
                                </button>
                                <button
                                    id="confirmAndClearDataBtn"
                                    class="px-4 py-2 text-white rounded-md transition border"
                                >
                                    <i class="fas fa-trash mr-1"></i> Да, очистить все данные
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Модальное окно Ссылки 1С -->
            <div
                id="cibLinkModal"
                class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 p-4 overflow-y-auto"
            >
                <div class="flex items-center justify-center min-h-full">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full">
                        <div class="p-content border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <h2 id="cibLinkModalTitle" class="text-xl font-bold">
                                    Добавить ссылку 1С
                                </h2>
                                <button
                                    class="close-modal p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                    title="Закрыть"
                                >
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>
                        </div>
                        <form id="cibLinkForm">
                            <div class="p-content space-y-4">
                                <input type="hidden" id="cibLinkId" />
                                <div>
                                    <label
                                        class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                        for="cibLinkTitle"
                                        >Название (для отображения)</label
                                    >
                                    <input
                                        type="text"
                                        id="cibLinkTitle"
                                        required
                                        class="w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                                    />
                                </div>
                                <div>
                                    <label
                                        class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                        for="cibLinkValue"
                                        >Ссылка 1С (e1cib/...)</label
                                    >
                                    <input
                                        type="text"
                                        id="cibLinkValue"
                                        required
                                        placeholder="e1cib/list/РегистрСведений.ЧтоТоТам"
                                        class="w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                                    />
                                </div>
                                <div>
                                    <label
                                        class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"
                                        for="cibLinkDescription"
                                        >Описание (опционально)</label
                                    >
                                    <textarea
                                        id="cibLinkDescription"
                                        rows="3"
                                        class="w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-base text-gray-900 dark:text-gray-100"
                                    ></textarea>
                                </div>
                            </div>
                            <div
                                class="p-content border-t border-gray-200 dark:border-gray-700 mt-auto"
                            >
                                <div class="flex justify-end gap-2">
                                    <button
                                        type="button"
                                        class="cancel-modal px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md transition"
                                    >
                                        Отмена
                                    </button>
                                    <button
                                        type="submit"
                                        id="saveCibLinkBtn"
                                        class="px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                                    >
                                        <i class="fas fa-save mr-1"></i> Сохранить
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div id="favoritesContent" class="tab-content hidden">
                <div class="bg-gray-100 dark:bg-gray-800 p-content rounded-lg shadow-md">
                    <div
                        class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-content"
                    >
                        <h2 class="text-2xl font-bold">Избранное</h2>
                        <div class="flex items-center gap-2">
                            <div
                                class="flex items-center space-x-1 border border-gray-300 dark:border-gray-600 rounded-md p-0.5"
                                role="group"
                            >
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="cards"
                                    title="Вид плитками"
                                >
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button
                                    class="view-toggle p-1.5 rounded"
                                    data-view="list"
                                    title="Вид списком"
                                >
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <button
                                id="clearFavoritesBtn"
                                class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition text-sm"
                                title="Очистить все избранное"
                            >
                                <i class="fas fa-trash-alt mr-1"></i> Очистить всё
                            </button>
                        </div>
                    </div>
                    <div
                        id="favoritesContainer"
                        class="grid gap-content auto-rows-fr"
                        data-section-id="favoritesContainer"
                        data-default-view="cards"
                    >
                        <p class="text-center py-6 text-gray-500 dark:text-gray-400 col-span-full">
                            В избранном пока ничего нет.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальное окно Горячие клавиши -->
        <div
            id="hotkeysModal"
            class="fixed inset-0 bg-black bg-opacity-60 hidden z-[80] p-4 overflow-y-auto"
        >
            <div class="flex items-center justify-center min-h-full">
                <div
                    class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col"
                >
                    <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                        <div class="flex justify-between items-center">
                            <h2
                                class="text-xl font-bold text-gray-900 dark:text-gray-100 flex items-center"
                            >
                                <i class="fas fa-keyboard mr-3 text-primary"></i>Горячие клавиши и
                                управление
                            </h2>
                            <div class="flex items-center flex-shrink-0">
                                <button
                                    id="toggleFullscreenHotkeysBtn"
                                    type="button"
                                    class="p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                    title="Развернуть на весь экран"
                                >
                                    <i class="fas fa-expand"></i>
                                </button>
                                <button
                                    id="closeHotkeysModalBtn"
                                    type="button"
                                    class="p-2 ml-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                    title="Закрыть (Esc)"
                                >
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="p-6 overflow-y-auto flex-1 text-sm leading-relaxed">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-x-8 gap-y-6">
                            <div class="space-y-6">
                                <section>
                                    <h3
                                        class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-1.5 flex items-center"
                                    >
                                        <i
                                            class="fas fa-compass w-6 text-center text-primary mr-2"
                                        ></i
                                        >Навигация по приложению
                                    </h3>
                                    <ul class="space-y-3 list-inside">
                                        <li>
                                            <code class="hotkey-code">Alt + H</code> — Перейти в
                                            раздел Главная.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + L</code> — Перейти в
                                            раздел Избранное.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + F</code> — Установить
                                            фокус на поле глобального поиска.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Backspace</code> (вне полей
                                            ввода) — Вернуться на предыдущий экран (например, из
                                            списка регламентов к категориям).
                                        </li>
                                    </ul>
                                </section>

                                <section>
                                    <h3
                                        class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-1.5 flex items-center"
                                    >
                                        <i
                                            class="fas fa-database w-6 text-center text-primary mr-2"
                                        ></i
                                        >Работа с данными
                                    </h3>
                                    <ul class="space-y-3 list-inside">
                                        <li>
                                            <code class="hotkey-code">Alt + S</code> — Сохранить
                                            изменения в активном окне создания/редактирования.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + N</code> — Открыть окно
                                            добавления нового элемента для текущей активной секции
                                            (алгоритма, закладки и т.д.).
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + Shift + S</code> —
                                            Экспортировать (сохранить) всю базу данных в файл.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + Shift + O</code> —
                                            Открыть диалог импорта (открытия) базы данных из файла.
                                        </li>
                                        <li>
                                            <code class="hotkey-code"
                                                >Ctr + ЛКМ (внутри поля ввода данных по
                                                клиенту)</code
                                            >
                                            Позволяет по единичному нажатию комбинации сразу и
                                            удобно копировать ИНН клиента в буфер обмена (при
                                            наличии фокуса в поле ввода).
                                        </li>
                                    </ul>
                                </section>
                            </div>

                            <div class="space-y-6">
                                <section>
                                    <h3
                                        class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-1.5 flex items-center"
                                    >
                                        <i
                                            class="fas fa-window-maximize w-6 text-center text-primary mr-2"
                                        ></i
                                        >Окна и интерфейс
                                    </h3>
                                    <ul class="space-y-3 list-inside">
                                        <li>
                                            <code class="hotkey-code">Alt + I</code> — Открыть окно
                                            настроек приложения.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + T</code> — Переключить
                                            тему (Авто / Светлая / Темная).
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + V</code> — Переключить
                                            вид отображения элементов (список/плитки) в текущей
                                            секции.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Alt + R</code> —
                                            Принудительная перезагрузка приложения.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Ctrl + Shift + H</code> —
                                            Открыть/закрыть это окно помощи.
                                        </li>
                                        <li>
                                            <code class="hotkey-code">Esc</code> — Закрыть самое
                                            верхнее активное окно. В полях поиска — очищает ввод.
                                        </li>
                                    </ul>
                                </section>

                                <section>
                                    <h3
                                        class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-1.5 flex items-center"
                                    >
                                        <i
                                            class="fas fa-tasks w-6 text-center text-primary mr-2"
                                        ></i
                                        >Контекстные действия
                                    </h3>
                                    <ul class="space-y-3 list-inside">
                                        <li>
                                            <b>Избранное:</b>
                                            <ul class="list-disc list-inside pl-5 mt-1 space-y-1">
                                                <li>
                                                    <code class="hotkey-code">Alt + K</code> —
                                                    Добавить/удалить текущий открытый элемент в
                                                    Избранное (в окне просмотра деталей).
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <b>Поле "Информация по обращению":</b>
                                            <ul class="list-disc list-inside pl-5 mt-1 space-y-1">
                                                <li>
                                                    <code class="hotkey-code">Ctrl + Enter</code> —
                                                    Вставить следующий пункт нумерованного списка.
                                                </li>
                                                <li>
                                                    <code class="hotkey-code"
                                                        >Ctrl + Shift + Backspace</code
                                                    >
                                                    — Очистить поле (с подтверждением).
                                                </li>
                                                <li>
                                                    <code class="hotkey-code">Alt + = / Alt -</code>
                                                    — Увеличить/уменьшить размер текста в окне
                                                    данных по обращению на Главной.
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <b>Таймер:</b>
                                            <ul class="list-disc list-inside pl-5 mt-1 space-y-1">
                                                <li>
                                                    Нажатие
                                                    <i class="fas fa-play w-4 text-center"></i> /
                                                    <i class="fas fa-pause w-4 text-center"></i>:
                                                    Старт/Пауза.
                                                </li>
                                                <li>
                                                    Нажатие
                                                    <i class="fas fa-undo w-4 text-center"></i>:
                                                    Сброс на стандартное время.
                                                </li>
                                                <li>
                                                    <code class="hotkey-code">Ctrl</code> + Нажатие
                                                    <i class="fas fa-undo w-4 text-center"></i>:
                                                    Сброс на 00:00.
                                                </li>
                                                <li>
                                                    Нажатие
                                                    <i class="fas fa-plus w-4 text-center"></i>:
                                                    Увеличить время.
                                                </li>
                                                <li>
                                                    Нажатие
                                                    <i class="fas fa-minus w-4 text-center"></i>:
                                                    Уменьшить время.
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <b>Просмотр изображений (Лайтбокс):</b>
                                            <ul class="list-disc list-inside pl-5 mt-1 space-y-1">
                                                <li>
                                                    <code class="hotkey-code"
                                                        ><i
                                                            class="fas fa-arrow-left w-3 text-center"
                                                        ></i
                                                    ></code>
                                                    /
                                                    <code class="hotkey-code"
                                                        ><i
                                                            class="fas fa-arrow-right w-3 text-center"
                                                        ></i
                                                    ></code>
                                                    — Предыдущее / следующее изображение.
                                                </li>
                                                <li>
                                                    <code class="hotkey-code">Колесо мыши</code> —
                                                    Масштабирование изображения.
                                                </li>
                                                <li>
                                                    <code class="hotkey-code">Перетаскивание</code>
                                                    — Перемещение увеличенного изображения.
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </section>
                            </div>
                        </div>
                    </div>

                    <div
                        class="p-4 border-t border-gray-200 dark:border-gray-700 mt-auto flex-shrink-0 text-right"
                    >
                        <button
                            type="button"
                            id="okHotkeysModalBtn"
                            class="px-5 py-2 bg-primary hover:bg-secondary text-white rounded-md transition"
                        >
                            OK
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div
            id="screenshotLightbox"
            tabindex="-1"
            class="fixed inset-0 bg-black bg-opacity-80 hidden z-[90] p-4 flex items-center justify-center backdrop-blur-sm overflow-hidden"
        >
            <div class="relative w-full h-full flex items-center justify-center">
                <img
                    id="lightboxImage"
                    src=""
                    alt="Просмотр скриншота"
                    class="max-w-[95%] max-h-[95%] object-contain hidden cursor-grab active:cursor-grabbing"
                    style="transition: transform 0.1s ease-out; transform-origin: center center"
                />

                <div
                    id="lightboxCounter"
                    class="absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white text-sm bg-black bg-opacity-50 px-2 py-1 rounded z-20"
                >
                    1 / 1
                </div>
                <button
                    id="closeLightboxBtn"
                    class="absolute top-4 right-4 text-white text-3xl opacity-80 hover:opacity-100 transition-opacity focus:outline-none focus:shadow-none z-20"
                    title="Закрыть (Esc)"
                >
                    ×
                </button>
                <button
                    id="prevLightboxBtn"
                    class="absolute left-4 top-1/2 transform -translate-y-1/2 text-white text-3xl opacity-50 hover:opacity-100 transition-opacity focus:outline-none p-2 bg-black bg-opacity-30 rounded-full z-20 disabled:opacity-20 disabled:cursor-not-allowed"
                    title="Предыдущее (←)"
                >
                    ‹
                </button>
                <button
                    id="nextLightboxBtn"
                    class="absolute right-4 top-1/2 transform -translate-y-1/2 text-white text-3xl opacity-50 hover:opacity-100 transition-opacity focus:outline-none p-2 bg-black bg-opacity-30 rounded-full z-20 disabled:opacity-20 disabled:cursor-not-allowed"
                    title="Следующее (→)"
                >
                    ›
                </button>
            </div>
        </div>

        <div id="app-copyright" class="p-3 text-center text-2xs">
            Copilot 1CO by @guthleifur -
            <a
                href="https://t.me/+AXt5_EROQrVkZDE6"
                target="_blank"
                rel="noopener noreferrer"
                class="hover:underline"
                >нажать сюда</a
            >
            для репорта об ошибках и предложений по усовершенстованию
        </div>

        <script src="./script.js"></script>
    </body>
</html>
